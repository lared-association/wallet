{"remainingRequest":"/home/hero/lared-wallet/node_modules/thread-loader/dist/cjs.js!/home/hero/lared-wallet/node_modules/babel-loader/lib/index.js!/home/hero/lared-wallet/node_modules/ts-loader/index.js??ref--13-3!/home/hero/lared-wallet/src/services/MosaicService.ts","dependencies":[{"path":"/home/hero/lared-wallet/src/services/MosaicService.ts","mtime":1606213958965},{"path":"/home/hero/lared-wallet/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/hero/lared-wallet/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/hero/lared-wallet/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/hero/lared-wallet/node_modules/ts-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZnVuY3Rpb24gX3RvQ29uc3VtYWJsZUFycmF5KGFycikgeyByZXR1cm4gX2FycmF5V2l0aG91dEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF9ub25JdGVyYWJsZVNwcmVhZCgpOyB9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVTcHJlYWQoKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7IH0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgeyBpZiAoU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChpdGVyKSB8fCBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoaXRlcikgPT09ICJbb2JqZWN0IEFyZ3VtZW50c10iKSByZXR1cm4gQXJyYXkuZnJvbShpdGVyKTsgfQoKZnVuY3Rpb24gX2FycmF5V2l0aG91dEhvbGVzKGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7IGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGFyci5sZW5ndGgpOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7IGFycjJbaV0gPSBhcnJbaV07IH0gcmV0dXJuIGFycjI7IH0gfQoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7IHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7IH0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UiKTsgfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgeyBpZiAoIShTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGFycikgfHwgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGFycikgPT09ICJbb2JqZWN0IEFyZ3VtZW50c10iKSkgeyByZXR1cm47IH0gdmFyIF9hcnIgPSBbXTsgdmFyIF9uID0gdHJ1ZTsgdmFyIF9kID0gZmFsc2U7IHZhciBfZSA9IHVuZGVmaW5lZDsgdHJ5IHsgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgeyBfYXJyLnB1c2goX3MudmFsdWUpOyBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7IH0gfSBjYXRjaCAoZXJyKSB7IF9kID0gdHJ1ZTsgX2UgPSBlcnI7IH0gZmluYWxseSB7IHRyeSB7IGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOyB9IGZpbmFsbHkgeyBpZiAoX2QpIHRocm93IF9lOyB9IH0gcmV0dXJuIF9hcnI7IH0KCmZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH0KCi8qCiAqIENvcHlyaWdodCAyMDIwIE5FTSAoaHR0cHM6Ly9uZW0uaW8pCiAqCiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKgogKi8KLy8gZXh0ZXJuYWwgZGVwZW5kZW5jaWVzCmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7CmltcG9ydCB7IE1vc2FpY0lkIH0gZnJvbSAnc3ltYm9sLXNkayc7CmltcG9ydCB7IGNvbWJpbmVMYXRlc3QsIGZyb20sIG9mIH0gZnJvbSAncnhqcyc7CmltcG9ydCB7IG1hcCwgbWVyZ2VNYXAsIHRhcCwgdG9BcnJheSB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJzsgLy8gaW50ZXJuYWwgZGVwZW5kZW5jaWVzCgppbXBvcnQgeyBNb3NhaWNDb25maWd1cmF0aW9uTW9kZWwgfSBmcm9tICdAL2NvcmUvZGF0YWJhc2UvZW50aXRpZXMvTW9zYWljQ29uZmlndXJhdGlvbk1vZGVsJzsKaW1wb3J0IHsgTW9zYWljTW9kZWwgfSBmcm9tICdAL2NvcmUvZGF0YWJhc2UvZW50aXRpZXMvTW9zYWljTW9kZWwnOwppbXBvcnQgeyBOZXR3b3JrQ3VycmVuY3lNb2RlbCB9IGZyb20gJ0AvY29yZS9kYXRhYmFzZS9lbnRpdGllcy9OZXR3b3JrQ3VycmVuY3lNb2RlbCc7CmltcG9ydCB7IE9ic2VydmFibGVIZWxwZXJzIH0gZnJvbSAnQC9jb3JlL3V0aWxzL09ic2VydmFibGVIZWxwZXJzJzsKaW1wb3J0IHsgVGltZUhlbHBlcnMgfSBmcm9tICdAL2NvcmUvdXRpbHMvVGltZUhlbHBlcnMnOwppbXBvcnQgeyBOZXR3b3JrQ3VycmVuY2llc01vZGVsIH0gZnJvbSAnQC9jb3JlL2RhdGFiYXNlL2VudGl0aWVzL05ldHdvcmtDdXJyZW5jaWVzTW9kZWwnOwppbXBvcnQgeyBNb3NhaWNNb2RlbFN0b3JhZ2UgfSBmcm9tICdAL2NvcmUvZGF0YWJhc2Uvc3RvcmFnZS9Nb3NhaWNNb2RlbFN0b3JhZ2UnOwppbXBvcnQgeyBOZXR3b3JrQ3VycmVuY2llc01vZGVsU3RvcmFnZSB9IGZyb20gJ0AvY29yZS9kYXRhYmFzZS9zdG9yYWdlL05ldHdvcmtDdXJyZW5jaWVzTW9kZWxTdG9yYWdlJzsKaW1wb3J0IHsgTW9zYWljQ29uZmlndXJhdGlvbk1vZGVsU3RvcmFnZSB9IGZyb20gJ0AvY29yZS9kYXRhYmFzZS9zdG9yYWdlL01vc2FpY0NvbmZpZ3VyYXRpb25Nb2RlbFN0b3JhZ2UnOwovKioKICogVGhlIHNlcnZpY2UgaW4gY2hhcmdlIG9mIGxvYWRpbmcgYW5kIGNhY2hpbmcgYW55dGhpbmcgcmVsYXRlZCB0byBNb3NhaWNzIGZyb20gUmVzdC4KICogVGhlIGNhY2hlIGlzIGRvbmUgYnkgc3RvcmluZyB0aGUgcGF5bG9hZHMgaW4gU2ltcGxlT2JqZWN0U3RvcmFnZS4KICoKICogVGhlIHNlcnZpY2UgYWxzbyBob2xkcyBjb25maWd1cmF0aW9uIGFib3V0IHRoZSBjdXJyZW50IG1vc2FpY3MsIGZvciBleGFtcGxlIHdoaWNoIG1vc2FpYwogKiBiYWxhbmNlcyBhcmUgY3VycmVudGx5IGhpZGRlbi4KICovCgpleHBvcnQgdmFyIE1vc2FpY1NlcnZpY2UgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIE1vc2FpY1NlcnZpY2UoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTW9zYWljU2VydmljZSk7CgogICAgLyoqCiAgICAgKiBTdG9yZSB0aGF0IGNhY2hlcyB0aGUgbW9zYWljIGluZm9ybWF0aW9uIG9mIHRoZSBjdXJyZW50IGFjY291bnRzIHdoZW4gcmV0dXJuZWQgZnJvbSByZXN0LgogICAgICovCiAgICB0aGlzLm1vc2FpY0RhdGFTdG9yYWdlID0gTW9zYWljTW9kZWxTdG9yYWdlLklOU1RBTkNFOwogICAgLyoqCiAgICAgKiBUaGUgc3RvcmFnZSB0byBrZWVwIHVzZXIgY29uZmlndXJhdGlvbiBhcm91bmQgbW9zYWljcy4gIEZvciBleGFtcGxlLCB0aGUgYmFsYW5jZSBoaWRkZW4KICAgICAqIGZlYXR1cmUuCiAgICAgKi8KCiAgICB0aGlzLm1vc2FpY0NvbmZpZ3VyYXRpb25zU3RvcmFnZSA9IE1vc2FpY0NvbmZpZ3VyYXRpb25Nb2RlbFN0b3JhZ2UuSU5TVEFOQ0U7CiAgICAvKioKICAgICAqIFN0b3JlIHRoYXQgY2FjaGVzIHRoZSBpbmZvcm1hdGlvbiBhcm91bmQgdGhlIG5ldHdvcmsgY3VycmVuY3kuCiAgICAgKi8KCiAgICB0aGlzLm5ldHdvcmtDdXJyZW5jeVN0b3JhZ2UgPSBOZXR3b3JrQ3VycmVuY2llc01vZGVsU3RvcmFnZS5JTlNUQU5DRTsKICB9CiAgLyoqCiAgICogVGhpcyBtZXRob2QgbG9hZHMgYW5kIGNhY2hlcyB0aGUgbW9zYWljIGluZm9ybWF0aW9uIGZvciB0aGUgZ2l2ZW4gYWNjb3VudHMuCiAgICogVGhlIHJldHVybmVkIE9ic2VydmFibGUgd2lsbCBhbm5vdW5jZSB0aGUgY2FjaGVkIGluZm9ybWF0aW9uIGZpcnN0LCB0aGVuIHRoZSByZXN0IHJldHVybmVkCiAgICogaW5mb3JtYXRpb24gKGlmIHBvc3NpYmxlKS4KICAgKgogICAqIEBwYXJhbSB7UmVwb3NpdG9yeUZhY3Rvcnl9IHJlcG9zaXRvcnlGYWN0b3J5CiAgICogQHBhcmFtIHtzdHJpbmd9IGdlbmVyYXRpb25IYXNoCiAgICogQHBhcmFtIHtOZXR3b3JrQ3VycmVuY3lNb2RlbH0gbmV0d29ya0N1cnJlbmN5CiAgICogQHBhcmFtIHtBY2NvdW50SW5mb1tdfSBhY2NvdW50c0luZm8KICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZTxNb3NhaWNNb2RlbFtdPn0KICAgKi8KCgogIF9jcmVhdGVDbGFzcyhNb3NhaWNTZXJ2aWNlLCBbewogICAga2V5OiAiZ2V0TW9zYWljcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TW9zYWljcyhyZXBvc2l0b3J5RmFjdG9yeSwgZ2VuZXJhdGlvbkhhc2gsIG5ldHdvcmtDdXJyZW5jeSwgYWNjb3VudHNJbmZvKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBpZiAoIWFjY291bnRzSW5mby5sZW5ndGgpIHsKICAgICAgICByZXR1cm4gb2YoW10pOwogICAgICB9CgogICAgICB2YXIgbW9zYWljRGF0YUxpc3QgPSB0aGlzLmxvYWRNb3NhaWNEYXRhKGdlbmVyYXRpb25IYXNoKSB8fCBbXTsKICAgICAgdmFyIHJlc29sdmVkQmFsYW5jZXNPYnNlcnZhYmxlID0gdGhpcy5yZXNvbHZlQmFsYW5jZXMocmVwb3NpdG9yeUZhY3RvcnksIGFjY291bnRzSW5mbyk7CiAgICAgIHZhciBhY2NvdW50QWRkcmVzc2VzID0gYWNjb3VudHNJbmZvLm1hcChmdW5jdGlvbiAoYSkgewogICAgICAgIHJldHVybiBhLmFkZHJlc3M7CiAgICAgIH0pOwogICAgICB2YXIgbW9zYWljc0Zyb21BY2NvdW50c09ic2VydmFibGUgPSByZXBvc2l0b3J5RmFjdG9yeS5jcmVhdGVNb3NhaWNSZXBvc2l0b3J5KCkuc2VhcmNoKHsKICAgICAgICBvd25lckFkZHJlc3M6IGFjY291bnRBZGRyZXNzZXNbMF0KICAgICAgfSk7CiAgICAgIHJldHVybiBjb21iaW5lTGF0ZXN0KFtyZXNvbHZlZEJhbGFuY2VzT2JzZXJ2YWJsZSwgbW9zYWljc0Zyb21BY2NvdW50c09ic2VydmFibGVdKS5waXBlKG1lcmdlTWFwKGZ1bmN0aW9uIChfcmVmKSB7CiAgICAgICAgdmFyIF9yZWYyID0gX3NsaWNlZFRvQXJyYXkoX3JlZiwgMiksCiAgICAgICAgICAgIGJhbGFuY2VzID0gX3JlZjJbMF0sCiAgICAgICAgICAgIG93ZWRNb3NhaWNzID0gX3JlZjJbMV07CgogICAgICAgIHZhciBtb3NhaWNJZHMgPSBfLnVuaXFCeShbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGJhbGFuY2VzLm1hcChmdW5jdGlvbiAobSkgewogICAgICAgICAgcmV0dXJuIG0ubW9zYWljSWQ7CiAgICAgICAgfSkpLCBfdG9Db25zdW1hYmxlQXJyYXkob3dlZE1vc2FpY3MuZGF0YS5tYXAoZnVuY3Rpb24gKG8pIHsKICAgICAgICAgIHJldHVybiBvLmlkOwogICAgICAgIH0pKSksIGZ1bmN0aW9uIChtKSB7CiAgICAgICAgICByZXR1cm4gbS50b0hleCgpOwogICAgICAgIH0pOwoKICAgICAgICB2YXIgbmFtZU9ic2VydmFibGVzID0gcmVwb3NpdG9yeUZhY3RvcnkuY3JlYXRlTmFtZXNwYWNlUmVwb3NpdG9yeSgpLmdldE1vc2FpY3NOYW1lcyhtb3NhaWNJZHMpOwoKICAgICAgICB2YXIgbW9zYWljSW5mb09ic2VydmFibGUgPSBfdGhpcy5sb2FkTW9zYWljKHJlcG9zaXRvcnlGYWN0b3J5LCBtb3NhaWNJZHMsIG93ZWRNb3NhaWNzLmRhdGEpOwoKICAgICAgICByZXR1cm4gY29tYmluZUxhdGVzdChbbmFtZU9ic2VydmFibGVzLCBtb3NhaWNJbmZvT2JzZXJ2YWJsZV0pLnBpcGUobWFwKGZ1bmN0aW9uIChfcmVmMykgewogICAgICAgICAgdmFyIF9yZWY0ID0gX3NsaWNlZFRvQXJyYXkoX3JlZjMsIDIpLAogICAgICAgICAgICAgIG5hbWVzID0gX3JlZjRbMF0sCiAgICAgICAgICAgICAgbW9zYWljSW5mb3MgPSBfcmVmNFsxXTsKCiAgICAgICAgICByZXR1cm4gX3RoaXMudG9Nb3NhaWNEdG9zKGJhbGFuY2VzLCBtb3NhaWNJbmZvcywgbmFtZXMsIG5ldHdvcmtDdXJyZW5jeSwgYWNjb3VudEFkZHJlc3Nlcyk7CiAgICAgICAgfSkpOwogICAgICB9KSkucGlwZSh0YXAoZnVuY3Rpb24gKGQpIHsKICAgICAgICByZXR1cm4gX3RoaXMuc2F2ZU1vc2FpY0RhdGEoZ2VuZXJhdGlvbkhhc2gsIGQpOwogICAgICB9KSwgT2JzZXJ2YWJsZUhlbHBlcnMuZGVmYXVsdEZpcnN0KG1vc2FpY0RhdGFMaXN0KSk7CiAgICB9CiAgfSwgewogICAga2V5OiAibG9hZE1vc2FpYyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbG9hZE1vc2FpYyhyZXBvc2l0b3J5RmFjdG9yeSwgbW9zYWljSWRzLCBhbHJlYWR5TG9hZGVkTW9zYWljcykgewogICAgICB2YXIgdG9Mb2FkTW9zYWljSWRzID0gbW9zYWljSWRzLmZpbHRlcihmdW5jdGlvbiAobW9zYWljSWQpIHsKICAgICAgICByZXR1cm4gIWFscmVhZHlMb2FkZWRNb3NhaWNzLnNvbWUoZnVuY3Rpb24gKGluZm8pIHsKICAgICAgICAgIHJldHVybiBpbmZvLmlkLmVxdWFscyhtb3NhaWNJZCk7CiAgICAgICAgfSk7CiAgICAgIH0pOwoKICAgICAgaWYgKHRvTG9hZE1vc2FpY0lkcy5sZW5ndGgpIHsKICAgICAgICByZXR1cm4gcmVwb3NpdG9yeUZhY3RvcnkuY3JlYXRlTW9zYWljUmVwb3NpdG9yeSgpLmdldE1vc2FpY3ModG9Mb2FkTW9zYWljSWRzKS5waXBlKG1hcChmdW5jdGlvbiAobmV3TW9zYWljcykgewogICAgICAgICAgcmV0dXJuIG5ld01vc2FpY3MuY29uY2F0KGFscmVhZHlMb2FkZWRNb3NhaWNzKTsKICAgICAgICB9KSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIG9mKGFscmVhZHlMb2FkZWRNb3NhaWNzKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImdldE5hbWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldE5hbWUobW9zYWljTmFtZXMsIGFjY291bnRNb3NhaWNEdG8pIHsKICAgICAgcmV0dXJuIF8uZmlyc3QobW9zYWljTmFtZXMuZmlsdGVyKGZ1bmN0aW9uIChuKSB7CiAgICAgICAgcmV0dXJuIG4ubW9zYWljSWQuZXF1YWxzKGFjY291bnRNb3NhaWNEdG8pOwogICAgICB9KS5maWx0ZXIoZnVuY3Rpb24gKG4pIHsKICAgICAgICByZXR1cm4gbi5uYW1lcy5sZW5ndGg7CiAgICAgIH0pLm1hcChmdW5jdGlvbiAobikgewogICAgICAgIHJldHVybiBuLm5hbWVzWzBdLm5hbWU7CiAgICAgIH0pKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ0b01vc2FpY0R0b3MiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHRvTW9zYWljRHRvcyhiYWxhbmNlcywgbW9zYWljRHRvcywgbW9zYWljTmFtZXMsIG5ldHdvcmtDdXJyZW5jeSwgYWNjb3VudEFkZHJlc3NlcykgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHJldHVybiBfLmZsYXR0ZW4oYWNjb3VudEFkZHJlc3Nlcy5tYXAoZnVuY3Rpb24gKGFkZHJlc3MpIHsKICAgICAgICByZXR1cm4gbW9zYWljRHRvcy5tYXAoZnVuY3Rpb24gKG1vc2FpY0R0bykgewogICAgICAgICAgdmFyIG5hbWUgPSBfdGhpczIuZ2V0TmFtZShtb3NhaWNOYW1lcywgbW9zYWljRHRvLmlkKTsKCiAgICAgICAgICB2YXIgaXNDdXJyZW5jeU1vc2FpYyA9IG1vc2FpY0R0by5pZC50b0hleCgpID09PSBuZXR3b3JrQ3VycmVuY3kubW9zYWljSWRIZXg7CiAgICAgICAgICB2YXIgYmFsYW5jZSA9IGJhbGFuY2VzLmZpbmQoZnVuY3Rpb24gKGJhbGFuY2UpIHsKICAgICAgICAgICAgcmV0dXJuIGJhbGFuY2UubW9zYWljSWQuZXF1YWxzKG1vc2FpY0R0by5pZCkgJiYgYmFsYW5jZS5hZGRyZXNzLmVxdWFscyhhZGRyZXNzKTsKICAgICAgICAgIH0pOwogICAgICAgICAgcmV0dXJuIG5ldyBNb3NhaWNNb2RlbChhZGRyZXNzLnBsYWluKCksIG1vc2FpY0R0by5vd25lckFkZHJlc3MucGxhaW4oKSwgbmFtZSwgaXNDdXJyZW5jeU1vc2FpYywgYmFsYW5jZSAmJiBiYWxhbmNlLmFtb3VudC5jb21wYWN0KCkgfHwgMCwgbW9zYWljRHRvKTsKICAgICAgICB9KTsKICAgICAgfSkpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlc29sdmVCYWxhbmNlcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVzb2x2ZUJhbGFuY2VzKHJlcG9zaXRvcnlGYWN0b3J5LCBhY2NvdW50c0luZm8pIHsKICAgICAgdmFyIG1vc2FpY0lkT3JBbGlhc2VzID0gXy5mbGF0dGVuKGFjY291bnRzSW5mby5tYXAoZnVuY3Rpb24gKGEpIHsKICAgICAgICByZXR1cm4gYS5tb3NhaWNzLm1hcChmdW5jdGlvbiAobSkgewogICAgICAgICAgcmV0dXJuIG0uaWQ7CiAgICAgICAgfSk7CiAgICAgIH0pKTsKCiAgICAgIHZhciBtb3NhaWNJZE9yQWxpYXNlc1VuaXF1ZSA9IF8udW5pcUJ5KG1vc2FpY0lkT3JBbGlhc2VzLCBmdW5jdGlvbiAobSkgewogICAgICAgIHJldHVybiBtLnRvSGV4KCk7CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIHRoaXMucmVzb2x2ZU1vc2FpY0lkcyhyZXBvc2l0b3J5RmFjdG9yeSwgbW9zYWljSWRPckFsaWFzZXNVbmlxdWUpLnBpcGUobWFwKGZ1bmN0aW9uIChyZXNvbHZlTW9zYWljSWRzKSB7CiAgICAgICAgcmV0dXJuIF8uZmxhdHRlbihhY2NvdW50c0luZm8ubWFwKGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICByZXR1cm4gYS5tb3NhaWNzLm1hcChmdW5jdGlvbiAobSkgewogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgIGFkZHJlc3M6IGEuYWRkcmVzcywKICAgICAgICAgICAgICBhbW91bnQ6IG0uYW1vdW50LAogICAgICAgICAgICAgIG1vc2FpY0lkOiByZXNvbHZlTW9zYWljSWRzLmZpbmQoZnVuY3Rpb24gKHBhaXIpIHsKICAgICAgICAgICAgICAgIHJldHVybiBwYWlyLmZyb20uZXF1YWxzKG0uaWQpOwogICAgICAgICAgICAgIH0pLnRvCiAgICAgICAgICAgIH07CiAgICAgICAgICB9KTsKICAgICAgICB9KSk7CiAgICAgIH0pKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZXNvbHZlTW9zYWljSWRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZXNvbHZlTW9zYWljSWRzKHJlcG9zaXRvcnlGYWN0b3J5LCBpZHMpIHsKICAgICAgdmFyIG5hbWVzcGFjZVJlcG9zaXRvcnkgPSByZXBvc2l0b3J5RmFjdG9yeS5jcmVhdGVOYW1lc3BhY2VSZXBvc2l0b3J5KCk7CiAgICAgIHJldHVybiBmcm9tKGlkcykucGlwZShtZXJnZU1hcChmdW5jdGlvbiAoaWQpIHsKICAgICAgICBpZiAoaWQgaW5zdGFuY2VvZiBNb3NhaWNJZCkgewogICAgICAgICAgcmV0dXJuIG9mKHsKICAgICAgICAgICAgZnJvbTogaWQsCiAgICAgICAgICAgIHRvOiBpZAogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHZhciBsaW5rZWRNb3NhaWNJZE9ic2VydmFibGUgPSBuYW1lc3BhY2VSZXBvc2l0b3J5LmdldExpbmtlZE1vc2FpY0lkKGlkKTsKICAgICAgICAgIHJldHVybiBsaW5rZWRNb3NhaWNJZE9ic2VydmFibGUucGlwZShtYXAoZnVuY3Rpb24gKHRvKSB7CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgZnJvbTogaWQsCiAgICAgICAgICAgICAgdG86IHRvCiAgICAgICAgICAgIH07CiAgICAgICAgICB9KSk7CiAgICAgICAgfQogICAgICB9KSkucGlwZSh0b0FycmF5KCkpOwogICAgfQogICAgLyoqCiAgICAgKiBUaGlzIG1ldGhvZCByZXR1cm5zIHRoZSBsaXN0IG9mIHtAbGluayBOZXR3b3JrQ3VycmVuY3lNb2RlbH0gb2YgdGhlIG5ldHdvcmsuCiAgICAgKgogICAgICogVGhlIGludGVudCBvZiB0aGlzIG1ldGhvZCBpcyB0byByZXNvbHZlIHRoZSBjb25maWd1cmVkIG1haW4gKGxpa2UgY2F0LmN1cnJlbmN5IG9yIHN5bWJvbC54eW0pCiAgICAgKiBhbmQgaGFydmVzdCBjdXJyZW5jaWVzIChjYXQuaGFydmVzdCkgcmV0dXJuZWQgYnkgdGhlIG5ldHdvcmsgY29uZmlndXJhdGlvbiBlbmRwb2ludC4KICAgICAqCiAgICAgKiBAcGFyYW0ge1JlcG9zaXRvcnlGYWN0b3J5fSByZXBvc2l0b3J5RmFjdG9yeQogICAgICogQHBhcmFtIHtnZW5lcmF0aW9uSGFzaH0gdGhlIGdlbmVyYXRpb24gaGFzaC4KICAgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlPE5ldHdvcmtDdXJyZW5jeU1vZGVsW10+fQogICAgICovCgogIH0sIHsKICAgIGtleTogImdldE5ldHdvcmtDdXJyZW5jaWVzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXROZXR3b3JrQ3VycmVuY2llcyhyZXBvc2l0b3J5RmFjdG9yeSwgZ2VuZXJhdGlvbkhhc2gpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICB2YXIgc3RvcmVkTmV0d29ya0N1cnJlbmNpZXMgPSB0aGlzLm5ldHdvcmtDdXJyZW5jeVN0b3JhZ2UuZ2V0KGdlbmVyYXRpb25IYXNoKTsKICAgICAgcmV0dXJuIHJlcG9zaXRvcnlGYWN0b3J5LmdldEN1cnJlbmNpZXMoKS5waXBlKG1hcChmdW5jdGlvbiAobmV0d29ya01vc2FpY3MpIHsKICAgICAgICB2YXIgY3VycmVuY3kgPSBfdGhpczMuZ2V0TmV0d29ya0N1cnJlbmN5KG5ldHdvcmtNb3NhaWNzLmN1cnJlbmN5KTsKCiAgICAgICAgdmFyIGhhcnZlc3QgPSBfdGhpczMuZ2V0TmV0d29ya0N1cnJlbmN5KG5ldHdvcmtNb3NhaWNzLmhhcnZlc3QpOwoKICAgICAgICByZXR1cm4gbmV3IE5ldHdvcmtDdXJyZW5jaWVzTW9kZWwoY3VycmVuY3ksIGhhcnZlc3QpOwogICAgICB9KSwgdGFwKGZ1bmN0aW9uIChkKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMy5uZXR3b3JrQ3VycmVuY3lTdG9yYWdlLnNldChnZW5lcmF0aW9uSGFzaCwgZCk7CiAgICAgIH0pLCBPYnNlcnZhYmxlSGVscGVycy5kZWZhdWx0Rmlyc3Qoc3RvcmVkTmV0d29ya0N1cnJlbmNpZXMpKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJsb2FkTW9zYWljRGF0YSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbG9hZE1vc2FpY0RhdGEoZ2VuZXJhdGlvbkhhc2gpIHsKICAgICAgcmV0dXJuIHRoaXMubW9zYWljRGF0YVN0b3JhZ2UuZ2V0KGdlbmVyYXRpb25IYXNoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzYXZlTW9zYWljRGF0YSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2F2ZU1vc2FpY0RhdGEoZ2VuZXJhdGlvbkhhc2gsIG1vc2FpY3MpIHsKICAgICAgdGhpcy5tb3NhaWNEYXRhU3RvcmFnZS5zZXQoZ2VuZXJhdGlvbkhhc2gsIG1vc2FpY3MpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlc2V0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZXNldChnZW5lcmF0aW9uSGFzaCkgewogICAgICB0aGlzLm1vc2FpY0RhdGFTdG9yYWdlLnJlbW92ZShnZW5lcmF0aW9uSGFzaCk7CiAgICAgIHRoaXMubmV0d29ya0N1cnJlbmN5U3RvcmFnZS5yZW1vdmUoZ2VuZXJhdGlvbkhhc2gpOwogICAgfQogICAgLyoqCiAgICAgKiBDcmVhdGVzIGEgbmV0d29yayBjdXJyZW5jeSBtb2RlbCBnaXZlbiBtb3NhaWMgaW5mbyBhbmQgbW9zYWljIG5hbWVzCiAgICAgKiBAcGFyYW0ge01vc2FpY0luZm99IG1vc2FpY0luZm8KICAgICAqIEBwYXJhbSB7TW9zYWljTmFtZXN9IG1vc2FpY05hbWUKICAgICAqIEByZXR1cm5zIHsoTmV0d29ya0N1cnJlbmN5TW9kZWwgfCB1bmRlZmluZWQpfQogICAgICovCgogIH0sIHsKICAgIGtleTogImdldE5ldHdvcmtDdXJyZW5jeSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TmV0d29ya0N1cnJlbmN5KGN1cnJlbmN5KSB7CiAgICAgIHZhciBtb3NhaWNJZCA9IGN1cnJlbmN5Lm1vc2FpY0lkOwogICAgICB2YXIgbmFtZXNwYWNlSWQgPSBjdXJyZW5jeS5uYW1lc3BhY2VJZDsKICAgICAgdmFyIHRpY2tlciA9IG5hbWVzcGFjZUlkICYmIG5hbWVzcGFjZUlkLmZ1bGxOYW1lICYmIG5hbWVzcGFjZUlkLmZ1bGxOYW1lLnNwbGl0KCcuJykucG9wKCkudG9VcHBlckNhc2UoKSB8fCB1bmRlZmluZWQ7CiAgICAgIHJldHVybiBuZXcgTmV0d29ya0N1cnJlbmN5TW9kZWwobW9zYWljSWQgPT09IG51bGwgfHwgbW9zYWljSWQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG1vc2FpY0lkLnRvSGV4KCksIG5hbWVzcGFjZUlkID09PSBudWxsIHx8IG5hbWVzcGFjZUlkID09PSB2b2lkIDAgPyB2b2lkIDAgOiBuYW1lc3BhY2VJZC50b0hleCgpLCBuYW1lc3BhY2VJZC5mdWxsTmFtZSwgY3VycmVuY3kuZGl2aXNpYmlsaXR5LCBjdXJyZW5jeS50cmFuc2ZlcmFibGUsIGN1cnJlbmN5LnN1cHBseU11dGFibGUsIGN1cnJlbmN5LnJlc3RyaWN0YWJsZSwgdGlja2VyKTsKICAgIH0KICAgIC8qKgogICAgICoKICAgICAqIFV0aWxpdHkgbWV0aG9kIHRoYXQgcmV0dXJucyB0aGUgbW9zYWljIGV4cGlyYXRpb24gc3RhdHVzCiAgICAgKiBAcGFyYW0gbW9zYWljSW5mbyB0aGUgbW9zYWljIGluZm8KICAgICAqIEBwYXJhbSBjdXJyZW50SGVpZ2h0CiAgICAgKiBAcGFyYW0gYmxvY2tHZW5lcmF0aW9uVGFyZ2V0VGltZQogICAgICovCgogIH0sIHsKICAgIGtleTogImdldE1vc2FpY0NvbmZpZ3VyYXRpb25zQnlBY2NvdW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRNb3NhaWNDb25maWd1cmF0aW9uc0J5QWNjb3VudChhY2NvdW50KSB7CiAgICAgIHJldHVybiB0aGlzLmdldE1vc2FpY0NvbmZpZ3VyYXRpb25zKClbYWNjb3VudC5pZF0gfHwge307CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0TW9zYWljQ29uZmlndXJhdGlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TW9zYWljQ29uZmlndXJhdGlvbihtb3NhaWNJZCwgYWNjb3VudCkgewogICAgICByZXR1cm4gdGhpcy5nZXRNb3NhaWNDb25maWd1cmF0aW9uc0J5QWNjb3VudChhY2NvdW50KVttb3NhaWNJZC50b0hleCgpXSB8fCBuZXcgTW9zYWljQ29uZmlndXJhdGlvbk1vZGVsKCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0TW9zYWljQ29uZmlndXJhdGlvbnMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldE1vc2FpY0NvbmZpZ3VyYXRpb25zKCkgewogICAgICByZXR1cm4gdGhpcy5tb3NhaWNDb25maWd1cmF0aW9uc1N0b3JhZ2UuZ2V0KCkgfHwge307CiAgICB9CiAgfSwgewogICAga2V5OiAiY2hhbmdlTW9zYWljQ29uZmlndXJhdGlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2hhbmdlTW9zYWljQ29uZmlndXJhdGlvbihtb3NhaWNJZCwgYWNjb3VudCwgbmV3Q29uZmlncykgewogICAgICB2YXIgbW9zYWljQ29uZmlndXJhdGlvbnNTdG9yYWdlID0gdGhpcy5nZXRNb3NhaWNDb25maWd1cmF0aW9ucygpOwogICAgICBtb3NhaWNDb25maWd1cmF0aW9uc1N0b3JhZ2VbYWNjb3VudC5pZF0gPSBtb3NhaWNDb25maWd1cmF0aW9uc1N0b3JhZ2VbYWNjb3VudC5pZF0gPyBtb3NhaWNDb25maWd1cmF0aW9uc1N0b3JhZ2VbYWNjb3VudC5pZF0gOiB7fTsKICAgICAgbW9zYWljQ29uZmlndXJhdGlvbnNTdG9yYWdlW2FjY291bnQuaWRdW21vc2FpY0lkLnRvSGV4KCldID0gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCB0aGlzLmdldE1vc2FpY0NvbmZpZ3VyYXRpb24obW9zYWljSWQsIGFjY291bnQpKSwgbmV3Q29uZmlncyk7CiAgICAgIHRoaXMubW9zYWljQ29uZmlndXJhdGlvbnNTdG9yYWdlLnNldChtb3NhaWNDb25maWd1cmF0aW9uc1N0b3JhZ2UpOwogICAgICByZXR1cm4gbW9zYWljQ29uZmlndXJhdGlvbnNTdG9yYWdlW2FjY291bnQuaWRdOwogICAgfQogIH1dLCBbewogICAga2V5OiAiZ2V0RXhwaXJhdGlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RXhwaXJhdGlvbihtb3NhaWNJbmZvLCBjdXJyZW50SGVpZ2h0LCBibG9ja0dlbmVyYXRpb25UYXJnZXRUaW1lKSB7CiAgICAgIHZhciBkdXJhdGlvbiA9IG1vc2FpY0luZm8uZHVyYXRpb247CiAgICAgIHZhciBzdGFydEhlaWdodCA9IG1vc2FpY0luZm8uaGVpZ2h0OyAvLyB1bmxpbWl0ZWQgZHVyYXRpb24gbW9zYWljcyBhcmUgZmxhZ2dlZCBhcyBkdXJhdGlvbiA9PSAwCgogICAgICBpZiAoZHVyYXRpb24gPT09IDApIHsKICAgICAgICByZXR1cm4gJ3VubGltaXRlZCc7CiAgICAgIH0gLy8gZ2V0IGN1cnJlbnQgaGVpZ2h0CiAgICAgIC8vIGNhbGN1bGF0ZSBleHBpcmF0aW9uCgoKICAgICAgdmFyIGV4cGlyZXNJbiA9IHN0YXJ0SGVpZ2h0ICsgZHVyYXRpb24gLSAoY3VycmVudEhlaWdodCB8fCAwKTsKCiAgICAgIGlmIChleHBpcmVzSW4gPD0gMCkgewogICAgICAgIHJldHVybiAnZXhwaXJlZCc7CiAgICAgIH0gLy8gbnVtYmVyIG9mIGJsb2NrcyByZW1haW5pbmcKCgogICAgICByZXR1cm4gVGltZUhlbHBlcnMuZHVyYXRpb25Ub1JlbGF0aXZlVGltZShleHBpcmVzSW4sIGJsb2NrR2VuZXJhdGlvblRhcmdldFRpbWUpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIE1vc2FpY1NlcnZpY2U7Cn0oKTs="},{"version":3,"sources":["/home/hero/lared-wallet/src/services/MosaicService.ts"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright 2020 NEM (https://nem.io)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\n// external dependencies\nimport _ from 'lodash';\nimport { AccountInfo, Address, Currency, MosaicId, MosaicInfo, MosaicNames, NamespaceId, RepositoryFactory, UInt64 } from 'symbol-sdk';\nimport { combineLatest, from, Observable, of } from 'rxjs';\nimport { map, mergeMap, tap, toArray } from 'rxjs/operators';\n// internal dependencies\nimport { MosaicConfigurationModel, AccountMosaicConfigurationModel } from '@/core/database/entities/MosaicConfigurationModel';\nimport { MosaicModel } from '@/core/database/entities/MosaicModel';\nimport { NetworkCurrencyModel } from '@/core/database/entities/NetworkCurrencyModel';\nimport { ObservableHelpers } from '@/core/utils/ObservableHelpers';\nimport { TimeHelpers } from '@/core/utils/TimeHelpers';\nimport { NetworkCurrenciesModel } from '@/core/database/entities/NetworkCurrenciesModel';\nimport { MosaicModelStorage } from '@/core/database/storage/MosaicModelStorage';\nimport { NetworkCurrenciesModelStorage } from '@/core/database/storage/NetworkCurrenciesModelStorage';\nimport { MosaicConfigurationModelStorage } from '@/core/database/storage/MosaicConfigurationModelStorage';\nimport { AccountModel } from '@/core/database/entities/AccountModel';\n\n// custom types\nexport type ExpirationStatus = 'unlimited' | 'expired' | string | number;\n\n// TODO. Can this interface be removed?\nexport interface AttachedMosaic {\n    id: MosaicId | NamespaceId;\n    mosaicHex: string;\n    /**\n     * Relative amount\n     */\n    amount: number;\n}\n\ninterface MosaicBalance {\n    mosaicId: MosaicId;\n    amount: UInt64;\n    address: Address;\n}\n\n/**\n * The service in charge of loading and caching anything related to Mosaics from Rest.\n * The cache is done by storing the payloads in SimpleObjectStorage.\n *\n * The service also holds configuration about the current mosaics, for example which mosaic\n * balances are currently hidden.\n */\nexport class MosaicService {\n    /**\n     * Store that caches the mosaic information of the current accounts when returned from rest.\n     */\n    private readonly mosaicDataStorage = MosaicModelStorage.INSTANCE;\n\n    /**\n     * The storage to keep user configuration around mosaics.  For example, the balance hidden\n     * feature.\n     */\n    private readonly mosaicConfigurationsStorage = MosaicConfigurationModelStorage.INSTANCE;\n\n    /**\n     * Store that caches the information around the network currency.\n     */\n    private readonly networkCurrencyStorage = NetworkCurrenciesModelStorage.INSTANCE;\n\n    /**\n     * This method loads and caches the mosaic information for the given accounts.\n     * The returned Observable will announce the cached information first, then the rest returned\n     * information (if possible).\n     *\n     * @param {RepositoryFactory} repositoryFactory\n     * @param {string} generationHash\n     * @param {NetworkCurrencyModel} networkCurrency\n     * @param {AccountInfo[]} accountsInfo\n     * @returns {Observable<MosaicModel[]>}\n     */\n    public getMosaics(\n        repositoryFactory: RepositoryFactory,\n        generationHash: string,\n        networkCurrency: NetworkCurrencyModel,\n        accountsInfo: AccountInfo[],\n    ): Observable<MosaicModel[]> {\n        if (!accountsInfo.length) {\n            return of([]);\n        }\n        const mosaicDataList = this.loadMosaicData(generationHash) || [];\n        const resolvedBalancesObservable = this.resolveBalances(repositoryFactory, accountsInfo);\n        const accountAddresses = accountsInfo.map((a) => a.address);\n        const mosaicsFromAccountsObservable = repositoryFactory.createMosaicRepository().search({ ownerAddress: accountAddresses[0] });\n\n        return combineLatest([resolvedBalancesObservable, mosaicsFromAccountsObservable])\n            .pipe(\n                mergeMap(([balances, owedMosaics]) => {\n                    const mosaicIds: MosaicId[] = _.uniqBy(\n                        [...balances.map((m) => m.mosaicId), ...owedMosaics.data.map((o) => o.id)],\n                        (m) => m.toHex(),\n                    );\n                    const nameObservables = repositoryFactory.createNamespaceRepository().getMosaicsNames(mosaicIds);\n                    const mosaicInfoObservable = this.loadMosaic(repositoryFactory, mosaicIds, owedMosaics.data);\n                    return combineLatest([nameObservables, mosaicInfoObservable]).pipe(\n                        map(([names, mosaicInfos]) => {\n                            return this.toMosaicDtos(balances, mosaicInfos, names, networkCurrency, accountAddresses);\n                        }),\n                    );\n                }),\n            )\n            .pipe(\n                tap((d) => this.saveMosaicData(generationHash, d)),\n                ObservableHelpers.defaultFirst(mosaicDataList),\n            );\n    }\n\n    private loadMosaic(\n        repositoryFactory: RepositoryFactory,\n        mosaicIds: MosaicId[],\n        alreadyLoadedMosaics: MosaicInfo[],\n    ): Observable<MosaicInfo[]> {\n        const toLoadMosaicIds = mosaicIds.filter((mosaicId) => !alreadyLoadedMosaics.some((info) => info.id.equals(mosaicId)));\n        if (toLoadMosaicIds.length) {\n            return repositoryFactory\n                .createMosaicRepository()\n                .getMosaics(toLoadMosaicIds)\n                .pipe(map((newMosaics) => newMosaics.concat(alreadyLoadedMosaics)));\n        } else {\n            return of(alreadyLoadedMosaics);\n        }\n    }\n\n    private getName(mosaicNames: MosaicNames[], accountMosaicDto: MosaicId): string {\n        return _.first(\n            mosaicNames\n                .filter((n) => n.mosaicId.equals(accountMosaicDto))\n                .filter((n) => n.names.length)\n                .map((n) => n.names[0].name),\n        );\n    }\n\n    private toMosaicDtos(\n        balances: MosaicBalance[],\n        mosaicDtos: MosaicInfo[],\n        mosaicNames: MosaicNames[],\n        networkCurrency: NetworkCurrencyModel,\n        accountAddresses: Address[],\n    ): MosaicModel[] {\n        return _.flatten(\n            accountAddresses.map((address) => {\n                return mosaicDtos.map((mosaicDto) => {\n                    const name = this.getName(mosaicNames, mosaicDto.id);\n                    const isCurrencyMosaic = mosaicDto.id.toHex() === networkCurrency.mosaicIdHex;\n                    const balance = balances.find((balance) => balance.mosaicId.equals(mosaicDto.id) && balance.address.equals(address));\n                    return new MosaicModel(\n                        address.plain(),\n                        mosaicDto.ownerAddress.plain(),\n                        name,\n                        isCurrencyMosaic,\n                        (balance && balance.amount.compact()) || 0,\n                        mosaicDto,\n                    );\n                });\n            }),\n        );\n    }\n\n    private resolveBalances(repositoryFactory: RepositoryFactory, accountsInfo: AccountInfo[]): Observable<MosaicBalance[]> {\n        const mosaicIdOrAliases = _.flatten(accountsInfo.map((a) => a.mosaics.map((m) => m.id)));\n        const mosaicIdOrAliasesUnique = _.uniqBy(mosaicIdOrAliases, (m) => m.toHex());\n        return this.resolveMosaicIds(repositoryFactory, mosaicIdOrAliasesUnique).pipe(\n            map((resolveMosaicIds) => {\n                return _.flatten(\n                    accountsInfo.map((a) => {\n                        return a.mosaics.map((m) => {\n                            return {\n                                address: a.address,\n                                amount: m.amount,\n                                mosaicId: resolveMosaicIds.find((pair) => pair.from.equals(m.id)).to,\n                            };\n                        });\n                    }),\n                );\n            }),\n        );\n    }\n\n    private resolveMosaicIds(\n        repositoryFactory: RepositoryFactory,\n        ids: (NamespaceId | MosaicId)[],\n    ): Observable<{ from: NamespaceId | MosaicId; to: MosaicId }[]> {\n        const namespaceRepository = repositoryFactory.createNamespaceRepository();\n        return from(ids)\n            .pipe(\n                mergeMap((id) => {\n                    if (id instanceof MosaicId) {\n                        return of({ from: id, to: id as MosaicId });\n                    } else {\n                        const linkedMosaicIdObservable = namespaceRepository.getLinkedMosaicId(id as NamespaceId);\n                        return linkedMosaicIdObservable.pipe(\n                            map((to) => {\n                                return { from: id, to: to };\n                            }),\n                        );\n                    }\n                }),\n            )\n            .pipe(toArray());\n    }\n\n    /**\n     * This method returns the list of {@link NetworkCurrencyModel} of the network.\n     *\n     * The intent of this method is to resolve the configured main (like cat.currency or symbol.xym)\n     * and harvest currencies (cat.harvest) returned by the network configuration endpoint.\n     *\n     * @param {RepositoryFactory} repositoryFactory\n     * @param {generationHash} the generation hash.\n     * @returns {Observable<NetworkCurrencyModel[]>}\n     */\n    public getNetworkCurrencies(repositoryFactory: RepositoryFactory, generationHash: string): Observable<NetworkCurrenciesModel> {\n        const storedNetworkCurrencies = this.networkCurrencyStorage.get(generationHash);\n        return repositoryFactory.getCurrencies().pipe(\n            map((networkMosaics) => {\n                const currency = this.getNetworkCurrency(networkMosaics.currency);\n                const harvest = this.getNetworkCurrency(networkMosaics.harvest);\n                return new NetworkCurrenciesModel(currency, harvest);\n            }),\n            tap((d) => this.networkCurrencyStorage.set(generationHash, d)),\n            ObservableHelpers.defaultFirst(storedNetworkCurrencies),\n        );\n    }\n\n    private loadMosaicData(generationHash: string): MosaicModel[] {\n        return this.mosaicDataStorage.get(generationHash);\n    }\n\n    private saveMosaicData(generationHash: string, mosaics: MosaicModel[]) {\n        this.mosaicDataStorage.set(generationHash, mosaics);\n    }\n\n    public reset(generationHash: string) {\n        this.mosaicDataStorage.remove(generationHash);\n        this.networkCurrencyStorage.remove(generationHash);\n    }\n\n    /**\n     * Creates a network currency model given mosaic info and mosaic names\n     * @param {MosaicInfo} mosaicInfo\n     * @param {MosaicNames} mosaicName\n     * @returns {(NetworkCurrencyModel | undefined)}\n     */\n    private getNetworkCurrency(currency: Currency): NetworkCurrencyModel {\n        const mosaicId = currency.mosaicId;\n        const namespaceId = currency.namespaceId;\n        const ticker = (namespaceId && namespaceId.fullName && namespaceId.fullName.split('.').pop().toUpperCase()) || undefined;\n        return new NetworkCurrencyModel(\n            mosaicId?.toHex(),\n            namespaceId?.toHex(),\n            namespaceId.fullName,\n            currency.divisibility,\n            currency.transferable,\n            currency.supplyMutable,\n            currency.restrictable,\n            ticker,\n        );\n    }\n\n    /**\n     *\n     * Utility method that returns the mosaic expiration status\n     * @param mosaicInfo the mosaic info\n     * @param currentHeight\n     * @param blockGenerationTargetTime\n     */\n    public static getExpiration(mosaicInfo: MosaicModel, currentHeight: number, blockGenerationTargetTime: number): ExpirationStatus {\n        const duration = mosaicInfo.duration;\n        const startHeight = mosaicInfo.height;\n\n        // unlimited duration mosaics are flagged as duration == 0\n        if (duration === 0) {\n            return 'unlimited';\n        }\n\n        // get current height\n        // calculate expiration\n        const expiresIn = startHeight + duration - (currentHeight || 0);\n        if (expiresIn <= 0) {\n            return 'expired';\n        }\n        // number of blocks remaining\n        return TimeHelpers.durationToRelativeTime(expiresIn, blockGenerationTargetTime);\n    }\n\n    public getMosaicConfigurationsByAccount(account: AccountModel): AccountMosaicConfigurationModel {\n        return this.getMosaicConfigurations()[account.id] || {};\n    }\n\n    public getMosaicConfiguration(mosaicId: MosaicId, account: AccountModel): MosaicConfigurationModel {\n        return this.getMosaicConfigurationsByAccount(account)[mosaicId.toHex()] || new MosaicConfigurationModel();\n    }\n    public getMosaicConfigurations(): Record<string, AccountMosaicConfigurationModel> {\n        return this.mosaicConfigurationsStorage.get() || {};\n    }\n    public changeMosaicConfiguration(mosaicId: MosaicId, account: AccountModel, newConfigs: any): Record<string, MosaicConfigurationModel> {\n        const mosaicConfigurationsStorage = this.getMosaicConfigurations();\n        mosaicConfigurationsStorage[account.id] = mosaicConfigurationsStorage[account.id] ? mosaicConfigurationsStorage[account.id] : {};\n        mosaicConfigurationsStorage[account.id][mosaicId.toHex()] = {\n            ...this.getMosaicConfiguration(mosaicId, account),\n            ...newConfigs,\n        };\n        this.mosaicConfigurationsStorage.set(mosaicConfigurationsStorage);\n        return mosaicConfigurationsStorage[account.id];\n    }\n}\n"],"sourceRoot":""}]}