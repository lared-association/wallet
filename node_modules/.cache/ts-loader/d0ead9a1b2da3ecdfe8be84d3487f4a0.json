{"remainingRequest":"/home/hero/lared-wallet/node_modules/thread-loader/dist/cjs.js!/home/hero/lared-wallet/node_modules/babel-loader/lib/index.js!/home/hero/lared-wallet/node_modules/ts-loader/index.js??ref--13-3!/home/hero/lared-wallet/src/services/DerivationService.ts","dependencies":[{"path":"/home/hero/lared-wallet/src/services/DerivationService.ts","mtime":1606213958965},{"path":"/home/hero/lared-wallet/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/hero/lared-wallet/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/hero/lared-wallet/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/hero/lared-wallet/node_modules/ts-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH0KCi8qCiAqIENvcHlyaWdodCAyMDIwIE5FTSAoaHR0cHM6Ly9uZW0uaW8pCiAqCiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKgogKi8KLy8gaW50ZXJuYWwgZGVwZW5kZW5jaWVzCmltcG9ydCB7IERlcml2YXRpb25QYXRoVmFsaWRhdG9yIH0gZnJvbSAnQC9jb3JlL3ZhbGlkYXRpb24vdmFsaWRhdG9ycyc7CmltcG9ydCB7IEFjY291bnRTZXJ2aWNlIH0gZnJvbSAnQC9zZXJ2aWNlcy9BY2NvdW50U2VydmljZSc7CmV4cG9ydCB2YXIgRGVyaXZhdGlvblBhdGhMZXZlbHM7CgooZnVuY3Rpb24gKERlcml2YXRpb25QYXRoTGV2ZWxzKSB7CiAgRGVyaXZhdGlvblBhdGhMZXZlbHNbRGVyaXZhdGlvblBhdGhMZXZlbHNbIlB1cnBvc2UiXSA9IDFdID0gIlB1cnBvc2UiOwogIERlcml2YXRpb25QYXRoTGV2ZWxzW0Rlcml2YXRpb25QYXRoTGV2ZWxzWyJDb2luVHlwZSJdID0gMl0gPSAiQ29pblR5cGUiOwogIERlcml2YXRpb25QYXRoTGV2ZWxzW0Rlcml2YXRpb25QYXRoTGV2ZWxzWyJQcm9maWxlIl0gPSAzXSA9ICJQcm9maWxlIjsKICBEZXJpdmF0aW9uUGF0aExldmVsc1tEZXJpdmF0aW9uUGF0aExldmVsc1siUmVtb3RlIl0gPSA0XSA9ICJSZW1vdGUiOwogIERlcml2YXRpb25QYXRoTGV2ZWxzW0Rlcml2YXRpb25QYXRoTGV2ZWxzWyJBZGRyZXNzIl0gPSA1XSA9ICJBZGRyZXNzIjsKfSkoRGVyaXZhdGlvblBhdGhMZXZlbHMgfHwgKERlcml2YXRpb25QYXRoTGV2ZWxzID0ge30pKTsKCmV4cG9ydCB2YXIgRGVyaXZhdGlvblNlcnZpY2UgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIERlcml2YXRpb25TZXJ2aWNlKCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIERlcml2YXRpb25TZXJ2aWNlKTsKICB9CgogIF9jcmVhdGVDbGFzcyhEZXJpdmF0aW9uU2VydmljZSwgW3sKICAgIGtleTogImlzVmFsaWRQYXRoIiwKCiAgICAvKioKICAgICAqIFZhbGlkYXRlIGRlcml2YXRpb24gcGF0aAogICAgICogQHBhcmFtIHtzdHJpbmd9IHBhdGgKICAgICAqIEByZXR1cm4ge2Jvb2xlYW59CiAgICAgKi8KICAgIHZhbHVlOiBmdW5jdGlvbiBpc1ZhbGlkUGF0aChwYXRoKSB7CiAgICAgIHJldHVybiBEZXJpdmF0aW9uUGF0aFZhbGlkYXRvci52YWxpZGF0ZShwYXRoKTsKICAgIH0KICAgIC8qKgogICAgICogSW5jcmVtZW50IGEgZGVyaXZhdGlvbiBwYXRoIGxldmVsCiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcGF0aAogICAgICogQHBhcmFtIHtEZXJpdmF0aW9uUGF0aExldmVsfSB3aGljaAogICAgICogQHJldHVybiB7c3RyaW5nfQogICAgICovCgogIH0sIHsKICAgIGtleTogImluY3JlbWVudFBhdGhMZXZlbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaW5jcmVtZW50UGF0aExldmVsKHBhdGgpIHsKICAgICAgdmFyIHdoaWNoID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBEZXJpdmF0aW9uUGF0aExldmVscy5Qcm9maWxlOwogICAgICB2YXIgc3RlcCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogMTsKICAgICAgLy8gbWFrZSBzdXJlIGRlcml2YXRpb24gcGF0aCBpcyB2YWxpZAogICAgICB0aGlzLmFzc2VydFZhbGlkUGF0aChwYXRoKTsgLy8gcHVycG9zZSBhbmQgY29pbiB0eXBlIGNhbm5vdCBiZSBjaGFuZ2VkCgogICAgICB0aGlzLmFzc2VydENhbk1vZGlmeUxldmVsKHdoaWNoKTsgLy8gcmVhZCBsZXZlbHMgYW5kIGluY3JlbWVudAoKICAgICAgdmFyIGluZGV4ID0gd2hpY2g7CiAgICAgIHZhciBwYXJ0cyA9IHBhdGguc3BsaXQoJy8nKTsgLy8gY2FsY3VsYXRlIG5leHQgaW5kZXggKGluY3JlbWVudCkKCiAgICAgIHZhciBuZXh0ID0gKHN0ZXAgPD0gMSA/IDEgOiBzdGVwKSArIHBhcnNlSW50KHBhcnRzW2luZGV4XS5yZXBsYWNlKC8nLywgJycpKTsgLy8gbW9kaWZ5IGFmZmVjdGVkIGxldmVsIG9ubHkKCiAgICAgIHJldHVybiBwYXJ0cy5tYXAoZnVuY3Rpb24gKGxldmVsLCBpZHgpIHsKICAgICAgICBpZiAoaWR4ICE9PSBpbmRleCkgewogICAgICAgICAgcmV0dXJuIGxldmVsOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuICIiLmNvbmNhdChuZXh0LCAiJyIpOwogICAgICB9KS5qb2luKCcvJyk7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgdGhlIGZpcnN0IG1pc3NpbmcgY29uc2VjdXRpdmUgYWNjb3VudCBwYXRoIGluIGEgcGF0aCBhcnJheQogICAgICogQHBhcmFtIHtzdHJpbmdbXX0gcGF0aHMKICAgICAqIEByZXR1cm5zIHtzdHJpbmd9CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0TmV4dEFjY291bnRQYXRoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXROZXh0QWNjb3VudFBhdGgocGF0aHMpIHsKICAgICAgdmFyIGRlZmF1bHRQYXRoID0gQWNjb3VudFNlcnZpY2UuREVGQVVMVF9BQ0NPVU5UX1BBVEg7IC8vIHJldHVybiB0aGUgZGVmYXVsdCBwYXRoIGlmIG5vIHBhdGggaW4gdGhlIGFycmF5CgogICAgICBpZiAoIXBhdGhzLmxlbmd0aCkgewogICAgICAgIHJldHVybiBkZWZhdWx0UGF0aDsKICAgICAgfSAvLyByZXR1cm4gdGhlIGRlZmF1bHQgcGF0aCBpZiBpdCBpcyBub3QgaW4gdGhlIGFycmF5CgoKICAgICAgaWYgKHBhdGhzLmluZGV4T2YoZGVmYXVsdFBhdGgpID09PSAtMSkgewogICAgICAgIHJldHVybiBkZWZhdWx0UGF0aDsKICAgICAgfSAvLyBnZXQgdGhlIHNvcnRlZCBwYXRoIGluZGV4ZXMgZm9yIHRoZSBnaXZlbiBkZXJpdmF0aW9uIHBhdGggbGV2ZWwKCgogICAgICB2YXIgcGF0aHNTb3J0ZWRCeUluZGV4ZXMgPSBwYXRocy5tYXAoZnVuY3Rpb24gKHBhdGgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgcGF0aDogcGF0aCwKICAgICAgICAgIHBhdGhJbmRleDogcGFyc2VJbnQocGF0aC5zcGxpdCgnLycpW0Rlcml2YXRpb25QYXRoTGV2ZWxzLlByb2ZpbGVdLCAxMCkKICAgICAgICB9OwogICAgICB9KS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgcmV0dXJuIGEucGF0aEluZGV4IC0gYi5wYXRoSW5kZXg7CiAgICAgIH0pOyAvLyBnZXQgdGhlIGZpcnN0IG5vbiBjb25zZWN1dGl2ZSBwYXRoIGluZGV4CgogICAgICB2YXIgZmlyc3RDYW5kaWRhdGUgPSBwYXRoc1NvcnRlZEJ5SW5kZXhlcyAvLyBmaWxsIGFuIGFycmF5IHdpdGggaW5kZXhlcyB3aXRoIG5vIGNvbnNlY3V0aXZlIG5leHQgaW5kZXgsIGFuZCB0aGUgbGFzdCBpbmRleAogICAgICAuZmlsdGVyKGZ1bmN0aW9uIChfcmVmLCBpLCBzZWxmKSB7CiAgICAgICAgdmFyIHBhdGhJbmRleCA9IF9yZWYucGF0aEluZGV4OwoKICAgICAgICAvLyB0aGUgbGFzdCBwYXRoIGlzIGFsd2F5cyBhIGNhbmRpZGF0ZQogICAgICAgIGlmIChpID09PSBzZWxmLmxlbmd0aCAtIDEpIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gLy8gbmV4dCBwYXRoIGlzIG5vdCBjb25zZWN1dGl2ZSwgYWRkIGl0IHRvIGNhbmRpZGF0ZXMKCgogICAgICAgIGlmIChzZWxmW2kgKyAxXS5wYXRoSW5kZXggIT09IHBhdGhJbmRleCArIDEpIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gLy8gbmV4dCBwYXRoIGlzIGNvbnNlY3V0aXZlLCBza2lwCgoKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0pLmZpbmQoZnVuY3Rpb24gKHBhdGgpIHsKICAgICAgICByZXR1cm4gcGF0aDsKICAgICAgfSk7IC8vIGZpbmQgdGhlIGZpcnN0IGNhbmRpZGF0ZQogICAgICAvLyByZXR1cm4gcGF0aCBpbmNyZW1lbnRlZCBmcm9tIHRoZSBmaXJzdCBjYW5kaWRhdGUKCiAgICAgIHJldHVybiB0aGlzLmluY3JlbWVudFBhdGhMZXZlbChmaXJzdENhbmRpZGF0ZS5wYXRoLCBEZXJpdmF0aW9uUGF0aExldmVscy5Qcm9maWxlKTsKICAgIH0KICAgIC8qKgogICAgICogRGVjcmVtZW50IGEgZGVyaXZhdGlvbiBwYXRoIGxldmVsCiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcGF0aAogICAgICogQHBhcmFtIHtEZXJpdmF0aW9uUGF0aExldmVsfSB3aGljaAogICAgICogQHJldHVybiB7c3RyaW5nfQogICAgICovCgogIH0sIHsKICAgIGtleTogImRlY3JlbWVudFBhdGhMZXZlbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGVjcmVtZW50UGF0aExldmVsKHBhdGgpIHsKICAgICAgdmFyIHdoaWNoID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBEZXJpdmF0aW9uUGF0aExldmVscy5Qcm9maWxlOwogICAgICB2YXIgc3RlcCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogMTsKICAgICAgLy8gbWFrZSBzdXJlIGRlcml2YXRpb24gcGF0aCBpcyB2YWxpZAogICAgICB0aGlzLmFzc2VydFZhbGlkUGF0aChwYXRoKTsgLy8gcHVycG9zZSBhbmQgY29pbiB0eXBlIGNhbm5vdCBiZSBjaGFuZ2VkCgogICAgICB0aGlzLmFzc2VydENhbk1vZGlmeUxldmVsKHdoaWNoKTsgLy8gcmVhZCBsZXZlbHMgYW5kIGluY3JlbWVudAoKICAgICAgdmFyIGluZGV4ID0gd2hpY2g7CiAgICAgIHZhciBwYXJ0cyA9IHBhdGguc3BsaXQoJy8nKTsgLy8gY2FsY3VsYXRlIG5leHQgaW5kZXggKGRlY3JlbWVudCkKCiAgICAgIHZhciBuZXh0ID0gcGFyc2VJbnQocGFydHNbaW5kZXhdLnJlcGxhY2UoLycvLCAnJykpIC0gKHN0ZXAgPD0gMSA/IDEgOiBzdGVwKTsKCiAgICAgIGlmIChuZXh0IDwgMCkgewogICAgICAgIG5leHQgPSAwOwogICAgICB9IC8vIG1vZGlmeSBhZmZlY3RlZCBsZXZlbCBvbmx5CgoKICAgICAgcmV0dXJuIHBhcnRzLm1hcChmdW5jdGlvbiAobGV2ZWwsIGlkeCkgewogICAgICAgIGlmIChpZHggIT09IGluZGV4KSB7CiAgICAgICAgICByZXR1cm4gbGV2ZWw7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gIiIuY29uY2F0KG5leHQsICInIik7CiAgICAgIH0pLmpvaW4oJy8nKTsKICAgIH0KICAgIC8qKgogICAgICogQXNzZXJ0IHdoZXRoZXIgXGEgcGF0aCBpcyBhIHZhbGlkIGRlcml2YXRpb24gcGF0aAogICAgICogQHBhcmFtIHtzdHJpbmd9IHBhdGgKICAgICAqIEByZXR1cm4ge3ZvaWR9CiAgICAgKiBAdGhyb3dzIHtFcnJvcn0gT24gXGEgcGF0aCB3aXRoIGludmFsaWQgZGVyaXZhdGlvbiBwYXRoCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiYXNzZXJ0VmFsaWRQYXRoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhc3NlcnRWYWxpZFBhdGgocGF0aCkgewogICAgICBpZiAoIXRoaXMuaXNWYWxpZFBhdGgocGF0aCkpIHsKICAgICAgICB2YXIgZXJyb3JNZXNzYWdlID0gJ0ludmFsaWQgZGVyaXZhdGlvbiBwYXRoOiAnICsgcGF0aDsKICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yTWVzc2FnZSk7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yTWVzc2FnZSk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQXNzZXJ0IHdoZXRoZXIgZGVyaXZhdGlvbiBwYXRoIGxldmVsIGNhbiBiZSBtb2RpZmllZAogICAgICogQHBhcmFtIHtEZXJpdmF0aW9uUGF0aExldmVsc30gd2hpY2gKICAgICAqIEByZXR1cm4ge3ZvaWR9CiAgICAgKiBAdGhyb3dzIHtFcnJvcn0gT24gXGEgd2hpY2ggd2l0aCBwcm90ZWN0ZWQgcGF0aCBsZXZlbCB2YWx1ZQogICAgICovCgogIH0sIHsKICAgIGtleTogImFzc2VydENhbk1vZGlmeUxldmVsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhc3NlcnRDYW5Nb2RpZnlMZXZlbCh3aGljaCkgewogICAgICB2YXIgcHJvdGVjdCA9IFtEZXJpdmF0aW9uUGF0aExldmVscy5QdXJwb3NlLCBEZXJpdmF0aW9uUGF0aExldmVscy5Db2luVHlwZV07CgogICAgICBpZiAodW5kZWZpbmVkICE9PSBwcm90ZWN0LmZpbmQoZnVuY3Rpb24gKHR5cGUpIHsKICAgICAgICByZXR1cm4gd2hpY2ggPT09IHR5cGU7CiAgICAgIH0pKSB7CiAgICAgICAgdmFyIGVycm9yTWVzc2FnZSA9ICJDYW5ub3QgbW9kaWZ5IGEgZGVyaXZhdGlvbiBwYXRoJ3MgcHVycG9zZSBhbmQgY29pbiB0eXBlIGxldmVscy4iOwogICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3JNZXNzYWdlKTsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKTsKICAgICAgfQogICAgfQogIH1dKTsKCiAgcmV0dXJuIERlcml2YXRpb25TZXJ2aWNlOwp9KCk7"},{"version":3,"sources":["/home/hero/lared-wallet/src/services/DerivationService.ts"],"names":[],"mappings":";;;;;;AAAA;;;;;;;;;;;;;;;AAeA;AACA,SAAS,uBAAT,QAAwC,8BAAxC;AACA,SAAS,cAAT,QAA+B,2BAA/B;AAEA,OAAA,IAAY,oBAAZ;;AAAA,CAAA,UAAY,oBAAZ,EAAgC;AAC5B,EAAA,oBAAA,CAAA,oBAAA,CAAA,SAAA,CAAA,GAAA,CAAA,CAAA,GAAA,SAAA;AACA,EAAA,oBAAA,CAAA,oBAAA,CAAA,UAAA,CAAA,GAAA,CAAA,CAAA,GAAA,UAAA;AACA,EAAA,oBAAA,CAAA,oBAAA,CAAA,SAAA,CAAA,GAAA,CAAA,CAAA,GAAA,SAAA;AACA,EAAA,oBAAA,CAAA,oBAAA,CAAA,QAAA,CAAA,GAAA,CAAA,CAAA,GAAA,QAAA;AACA,EAAA,oBAAA,CAAA,oBAAA,CAAA,SAAA,CAAA,GAAA,CAAA,CAAA,GAAA,SAAA;AACH,CAND,EAAY,oBAAoB,KAApB,oBAAoB,GAAA,EAAA,CAAhC;;AAQA,WAAa,iBAAb;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACI;;;;;AADJ,gCAMuB,IANvB,EAMmC;AAC3B,aAAO,uBAAuB,CAAC,QAAxB,CAAiC,IAAjC,CAAP;AACH;AAED;;;;;;;AAVJ;AAAA;AAAA,uCAgB8B,IAhB9B,EAgBwH;AAAA,UAA5E,KAA4E,uEAA9C,oBAAoB,CAAC,OAAyB;AAAA,UAAhB,IAAgB,uEAAD,CAAC;AAChH;AACA,WAAK,eAAL,CAAqB,IAArB,EAFgH,CAIhH;;AACA,WAAK,oBAAL,CAA0B,KAA1B,EALgH,CAOhH;;AACA,UAAM,KAAK,GAAG,KAAd;AACA,UAAM,KAAK,GAAG,IAAI,CAAC,KAAL,CAAW,GAAX,CAAd,CATgH,CAWhH;;AACA,UAAM,IAAI,GAAG,CAAC,IAAI,IAAI,CAAR,GAAY,CAAZ,GAAgB,IAAjB,IAAyB,QAAQ,CAAC,KAAK,CAAC,KAAD,CAAL,CAAa,OAAb,CAAqB,GAArB,EAA0B,EAA1B,CAAD,CAA9C,CAZgH,CAchH;;AACA,aAAO,KAAK,CACP,GADE,CACE,UAAC,KAAD,EAAQ,GAAR,EAAe;AAChB,YAAI,GAAG,KAAK,KAAZ,EAAmB;AACf,iBAAO,KAAP;AACH;;AACD,yBAAU,IAAV;AACH,OANE,EAOF,IAPE,CAOG,GAPH,CAAP;AAQH;AAED;;;;;;AAzCJ;AAAA;AAAA,uCA8C8B,KA9C9B,EA8C6C;AACrC,UAAM,WAAW,GAAG,cAAc,CAAC,oBAAnC,CADqC,CAGrC;;AACA,UAAI,CAAC,KAAK,CAAC,MAAX,EAAmB;AACf,eAAO,WAAP;AACH,OANoC,CAQrC;;;AACA,UAAI,KAAK,CAAC,OAAN,CAAc,WAAd,MAA+B,CAAC,CAApC,EAAuC;AACnC,eAAO,WAAP;AACH,OAXoC,CAarC;;;AACA,UAAM,oBAAoB,GAAG,KAAK,CAC7B,GADwB,CACpB,UAAC,IAAD;AAAA,eAAW;AACZ,UAAA,IAAI,EAAJ,IADY;AAEZ,UAAA,SAAS,EAAE,QAAQ,CAAC,IAAI,CAAC,KAAL,CAAW,GAAX,EAAgB,oBAAoB,CAAC,OAArC,CAAD,EAAgD,EAAhD;AAFP,SAAX;AAAA,OADoB,EAKxB,IALwB,CAKnB,UAAC,CAAD,EAAI,CAAJ;AAAA,eAAU,CAAC,CAAC,SAAF,GAAc,CAAC,CAAC,SAA1B;AAAA,OALmB,CAA7B,CAdqC,CAqBrC;;AACA,UAAM,cAAc,GAAG,oBAAoB,CACvC;AADuC,OAEtC,MAFkB,CAEX,gBAAgB,CAAhB,EAAmB,IAAnB,EAA2B;AAAA,YAAxB,SAAwB,QAAxB,SAAwB;;AAC/B;AACA,YAAI,CAAC,KAAK,IAAI,CAAC,MAAL,GAAc,CAAxB,EAA2B;AACvB,iBAAO,IAAP;AACH,SAJ8B,CAM/B;;;AACA,YAAI,IAAI,CAAC,CAAC,GAAG,CAAL,CAAJ,CAAY,SAAZ,KAA0B,SAAS,GAAG,CAA1C,EAA6C;AACzC,iBAAO,IAAP;AACH,SAT8B,CAW/B;;;AACA,eAAO,KAAP;AACH,OAfkB,EAgBlB,IAhBkB,CAgBb,UAAC,IAAD;AAAA,eAAU,IAAV;AAAA,OAhBa,CAAvB,CAtBqC,CAsCV;AAE3B;;AACA,aAAO,KAAK,kBAAL,CAAwB,cAAc,CAAC,IAAvC,EAA6C,oBAAoB,CAAC,OAAlE,CAAP;AACH;AAED;;;;;;;AA1FJ;AAAA;AAAA,uCAgG8B,IAhG9B,EAgGwH;AAAA,UAA5E,KAA4E,uEAA9C,oBAAoB,CAAC,OAAyB;AAAA,UAAhB,IAAgB,uEAAD,CAAC;AAChH;AACA,WAAK,eAAL,CAAqB,IAArB,EAFgH,CAIhH;;AACA,WAAK,oBAAL,CAA0B,KAA1B,EALgH,CAOhH;;AACA,UAAM,KAAK,GAAG,KAAd;AACA,UAAM,KAAK,GAAG,IAAI,CAAC,KAAL,CAAW,GAAX,CAAd,CATgH,CAWhH;;AACA,UAAI,IAAI,GAAG,QAAQ,CAAC,KAAK,CAAC,KAAD,CAAL,CAAa,OAAb,CAAqB,GAArB,EAA0B,EAA1B,CAAD,CAAR,IAA2C,IAAI,IAAI,CAAR,GAAY,CAAZ,GAAgB,IAA3D,CAAX;;AACA,UAAI,IAAI,GAAG,CAAX,EAAc;AACV,QAAA,IAAI,GAAG,CAAP;AACH,OAf+G,CAiBhH;;;AACA,aAAO,KAAK,CACP,GADE,CACE,UAAC,KAAD,EAAQ,GAAR,EAAe;AAChB,YAAI,GAAG,KAAK,KAAZ,EAAmB;AACf,iBAAO,KAAP;AACH;;AACD,yBAAU,IAAV;AACH,OANE,EAOF,IAPE,CAOG,GAPH,CAAP;AAQH;AAED;;;;;;;AA5HJ;AAAA;AAAA,oCAkI2B,IAlI3B,EAkIuC;AAC/B,UAAI,CAAC,KAAK,WAAL,CAAiB,IAAjB,CAAL,EAA6B;AACzB,YAAM,YAAY,GAAG,8BAA8B,IAAnD;AACA,QAAA,OAAO,CAAC,KAAR,CAAc,YAAd;AACA,cAAM,IAAI,KAAJ,CAAU,YAAV,CAAN;AACH;AACJ;AAED;;;;;;;AA1IJ;AAAA;AAAA,yCAgJgC,KAhJhC,EAgJ2D;AACnD,UAAM,OAAO,GAAG,CAAC,oBAAoB,CAAC,OAAtB,EAA+B,oBAAoB,CAAC,QAApD,CAAhB;;AACA,UAAI,SAAS,KAAK,OAAO,CAAC,IAAR,CAAa,UAAC,IAAD;AAAA,eAAU,KAAK,KAAK,IAApB;AAAA,OAAb,CAAlB,EAA0D;AACtD,YAAM,YAAY,GAAG,iEAArB;AACA,QAAA,OAAO,CAAC,KAAR,CAAc,YAAd;AACA,cAAM,IAAI,KAAJ,CAAU,YAAV,CAAN;AACH;AACJ;AAvJL;;AAAA;AAAA","sourcesContent":["/*\n * Copyright 2020 NEM (https://nem.io)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\n// internal dependencies\nimport { DerivationPathValidator } from '@/core/validation/validators';\nimport { AccountService } from '@/services/AccountService';\n\nexport enum DerivationPathLevels {\n    Purpose = 1,\n    CoinType = 2,\n    Profile = 3,\n    Remote = 4, // BIP44=change\n    Address = 5,\n}\n\nexport class DerivationService {\n    /**\n     * Validate derivation path\n     * @param {string} path\n     * @return {boolean}\n     */\n    public isValidPath(path: string): boolean {\n        return DerivationPathValidator.validate(path);\n    }\n\n    /**\n     * Increment a derivation path level\n     * @param {string} path\n     * @param {DerivationPathLevel} which\n     * @return {string}\n     */\n    public incrementPathLevel(path: string, which: DerivationPathLevels = DerivationPathLevels.Profile, step: number = 1): string {\n        // make sure derivation path is valid\n        this.assertValidPath(path);\n\n        // purpose and coin type cannot be changed\n        this.assertCanModifyLevel(which);\n\n        // read levels and increment\n        const index = which as number;\n        const parts = path.split('/');\n\n        // calculate next index (increment)\n        const next = (step <= 1 ? 1 : step) + parseInt(parts[index].replace(/'/, ''));\n\n        // modify affected level only\n        return parts\n            .map((level, idx) => {\n                if (idx !== index) {\n                    return level;\n                }\n                return `${next}'`;\n            })\n            .join('/');\n    }\n\n    /**\n     * Returns the first missing consecutive account path in a path array\n     * @param {string[]} paths\n     * @returns {string}\n     */\n    public getNextAccountPath(paths: string[]): string {\n        const defaultPath = AccountService.DEFAULT_ACCOUNT_PATH;\n\n        // return the default path if no path in the array\n        if (!paths.length) {\n            return defaultPath;\n        }\n\n        // return the default path if it is not in the array\n        if (paths.indexOf(defaultPath) === -1) {\n            return defaultPath;\n        }\n\n        // get the sorted path indexes for the given derivation path level\n        const pathsSortedByIndexes = paths\n            .map((path) => ({\n                path,\n                pathIndex: parseInt(path.split('/')[DerivationPathLevels.Profile], 10),\n            }))\n            .sort((a, b) => a.pathIndex - b.pathIndex);\n\n        // get the first non consecutive path index\n        const firstCandidate = pathsSortedByIndexes\n            // fill an array with indexes with no consecutive next index, and the last index\n            .filter(({ pathIndex }, i, self) => {\n                // the last path is always a candidate\n                if (i === self.length - 1) {\n                    return true;\n                }\n\n                // next path is not consecutive, add it to candidates\n                if (self[i + 1].pathIndex !== pathIndex + 1) {\n                    return true;\n                }\n\n                // next path is consecutive, skip\n                return false;\n            })\n            .find((path) => path); // find the first candidate\n\n        // return path incremented from the first candidate\n        return this.incrementPathLevel(firstCandidate.path, DerivationPathLevels.Profile);\n    }\n\n    /**\n     * Decrement a derivation path level\n     * @param {string} path\n     * @param {DerivationPathLevel} which\n     * @return {string}\n     */\n    public decrementPathLevel(path: string, which: DerivationPathLevels = DerivationPathLevels.Profile, step: number = 1): string {\n        // make sure derivation path is valid\n        this.assertValidPath(path);\n\n        // purpose and coin type cannot be changed\n        this.assertCanModifyLevel(which);\n\n        // read levels and increment\n        const index = which as number;\n        const parts = path.split('/');\n\n        // calculate next index (decrement)\n        let next = parseInt(parts[index].replace(/'/, '')) - (step <= 1 ? 1 : step);\n        if (next < 0) {\n            next = 0;\n        }\n\n        // modify affected level only\n        return parts\n            .map((level, idx) => {\n                if (idx !== index) {\n                    return level;\n                }\n                return `${next}'`;\n            })\n            .join('/');\n    }\n\n    /**\n     * Assert whether \\a path is a valid derivation path\n     * @param {string} path\n     * @return {void}\n     * @throws {Error} On \\a path with invalid derivation path\n     */\n    public assertValidPath(path: string): void {\n        if (!this.isValidPath(path)) {\n            const errorMessage = 'Invalid derivation path: ' + path;\n            console.error(errorMessage);\n            throw new Error(errorMessage);\n        }\n    }\n\n    /**\n     * Assert whether derivation path level can be modified\n     * @param {DerivationPathLevels} which\n     * @return {void}\n     * @throws {Error} On \\a which with protected path level value\n     */\n    public assertCanModifyLevel(which: DerivationPathLevels): void {\n        const protect = [DerivationPathLevels.Purpose, DerivationPathLevels.CoinType];\n        if (undefined !== protect.find((type) => which === type)) {\n            const errorMessage = \"Cannot modify a derivation path's purpose and coin type levels.\";\n            console.error(errorMessage);\n            throw new Error(errorMessage);\n        }\n    }\n}\n"],"sourceRoot":""}]}