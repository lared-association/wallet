{"remainingRequest":"/home/hero/lared-wallet/node_modules/thread-loader/dist/cjs.js!/home/hero/lared-wallet/node_modules/babel-loader/lib/index.js!/home/hero/lared-wallet/node_modules/ts-loader/index.js??ref--13-3!/home/hero/lared-wallet/src/services/NetworkService.ts","dependencies":[{"path":"/home/hero/lared-wallet/src/services/NetworkService.ts","mtime":1606213958965},{"path":"/home/hero/lared-wallet/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/hero/lared-wallet/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/hero/lared-wallet/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/hero/lared-wallet/node_modules/ts-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZnVuY3Rpb24gX3RvQ29uc3VtYWJsZUFycmF5KGFycikgeyByZXR1cm4gX2FycmF5V2l0aG91dEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF9ub25JdGVyYWJsZVNwcmVhZCgpOyB9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVTcHJlYWQoKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7IH0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgeyBpZiAoU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChpdGVyKSB8fCBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoaXRlcikgPT09ICJbb2JqZWN0IEFyZ3VtZW50c10iKSByZXR1cm4gQXJyYXkuZnJvbShpdGVyKTsgfQoKZnVuY3Rpb24gX2FycmF5V2l0aG91dEhvbGVzKGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7IGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGFyci5sZW5ndGgpOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7IGFycjJbaV0gPSBhcnJbaV07IH0gcmV0dXJuIGFycjI7IH0gfQoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7IHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7IH0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UiKTsgfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgeyBpZiAoIShTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGFycikgfHwgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGFycikgPT09ICJbb2JqZWN0IEFyZ3VtZW50c10iKSkgeyByZXR1cm47IH0gdmFyIF9hcnIgPSBbXTsgdmFyIF9uID0gdHJ1ZTsgdmFyIF9kID0gZmFsc2U7IHZhciBfZSA9IHVuZGVmaW5lZDsgdHJ5IHsgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgeyBfYXJyLnB1c2goX3MudmFsdWUpOyBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7IH0gfSBjYXRjaCAoZXJyKSB7IF9kID0gdHJ1ZTsgX2UgPSBlcnI7IH0gZmluYWxseSB7IHRyeSB7IGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOyB9IGZpbmFsbHkgeyBpZiAoX2QpIHRocm93IF9lOyB9IH0gcmV0dXJuIF9hcnI7IH0KCmZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH0KCi8qCiAqIENvcHlyaWdodCAyMDIwIE5FTSAoaHR0cHM6Ly9uZW0uaW8pCiAqCiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKgogKi8KaW1wb3J0IHsgTmV0d29ya01vZGVsIH0gZnJvbSAnQC9jb3JlL2RhdGFiYXNlL2VudGl0aWVzL05ldHdvcmtNb2RlbCc7CmltcG9ydCB7IFJlcG9zaXRvcnlGYWN0b3J5SHR0cCB9IGZyb20gJ3N5bWJvbC1zZGsnOwppbXBvcnQgeyBVUkxIZWxwZXJzIH0gZnJvbSAnQC9jb3JlL3V0aWxzL1VSTEhlbHBlcnMnOwppbXBvcnQgeyBjb21iaW5lTGF0ZXN0LCBkZWZlciwgRU1QVFksIGZyb20gfSBmcm9tICdyeGpzJzsKaW1wb3J0IHsgY2F0Y2hFcnJvciwgY29uY2F0TWFwLCBmbGF0TWFwLCBtYXAsIHRha2UsIHRhcCwgaXNFbXB0eSB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJzsKaW1wb3J0ICogYXMgXyBmcm9tICdsb2Rhc2gnOwppbXBvcnQgeyBPYnNlcnZhYmxlSGVscGVycyB9IGZyb20gJ0AvY29yZS91dGlscy9PYnNlcnZhYmxlSGVscGVycyc7CmltcG9ydCB7IG5ldHdvcmtDb25maWcgfSBmcm9tICdAL2NvbmZpZyc7CmltcG9ydCB7IE5ldHdvcmtDb25maWd1cmF0aW9uSGVscGVycyB9IGZyb20gJ0AvY29yZS91dGlscy9OZXR3b3JrQ29uZmlndXJhdGlvbkhlbHBlcnMnOwppbXBvcnQgeyBOZXR3b3JrTW9kZWxTdG9yYWdlIH0gZnJvbSAnQC9jb3JlL2RhdGFiYXNlL3N0b3JhZ2UvTmV0d29ya01vZGVsU3RvcmFnZSc7Ci8qKgogKiBUaGUgc2VydmljZSBpbiBjaGFyZ2Ugb2YgbG9hZGluZyBhbmQgY2FjaGluZyBhbnl0aGluZyByZWxhdGVkIHRvIE5ldHdvcmsgZnJvbSBSZXN0LgogKiBUaGUgY2FjaGUgaXMgZG9uZSBieSBzdG9yaW5nIHRoZSBwYXlsb2FkcyBpbiBTaW1wbGVPYmplY3RTdG9yYWdlLgogKi8KCmV4cG9ydCB2YXIgTmV0d29ya1NlcnZpY2UgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIE5ldHdvcmtTZXJ2aWNlKCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE5ldHdvcmtTZXJ2aWNlKTsKCiAgICAvKioKICAgICAqIFRoZSBuZXR3b3JrIGluZm9ybWF0aW9uIGxvY2FsIGNhY2hlLgogICAgICovCiAgICB0aGlzLnN0b3JhZ2UgPSBOZXR3b3JrTW9kZWxTdG9yYWdlLklOU1RBTkNFOwogIH0KICAvKioKICAgKiBUaGUgYmVzdCBkZWZhdWx0IFVybC4gSXQgdXNlcyB0aGUgc3RvcmVkIGNvbmRpZ3VyYXRpb24gaWYgcG9zc2libGUuCiAgICovCgoKICBfY3JlYXRlQ2xhc3MoTmV0d29ya1NlcnZpY2UsIFt7CiAgICBrZXk6ICJnZXREZWZhdWx0VXJsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXREZWZhdWx0VXJsKCkgewogICAgICB2YXIgc3RvcmVkTmV0d29ya01vZGVsID0gdGhpcy5zdG9yYWdlLmdldExhdGVzdCgpOwogICAgICByZXR1cm4gVVJMSGVscGVycy5mb3JtYXRVcmwoc3RvcmVkTmV0d29ya01vZGVsICYmIHN0b3JlZE5ldHdvcmtNb2RlbC51cmwgfHwgbmV0d29ya0NvbmZpZy5kZWZhdWx0Tm9kZVVybCkudXJsOwogICAgfQogICAgLyoqCiAgICAgKiBUaGlzIG1ldGhvZCBnZXQgdGhlIG5ldHdvcmsgZGF0YSBmcm9tIHRoZSBwcm92aWRlZCBVUkwuIElmIHRoZSBzZXJ2ZXIgaW4gdGhlIGNhbmRpZGF0ZVVybCBpcyBkb3duLAogICAgICogdGhlIG5leHQgYXZhaWxhYmxlIHVybCB3aWxsIGJlIHVzZWQuCiAgICAgKgogICAgICogQHBhcmFtIGNhbmRpZGF0ZVVybCB0aGUgbmV3IHVybC4KICAgICAqIEBwYXJhbSBnZW5lcmF0aW9uSGFzaCBvZiB0aGUgY3VycmVudCBwcm9maWxlCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0TmV0d29ya01vZGVsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXROZXR3b3JrTW9kZWwoY2FuZGlkYXRlVXJsLCBnZW5lcmF0aW9uSGFzaCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIHBvc3NpYmxlVXJscyA9IHRoaXMucmVzb2x2ZUNhbmRpZGF0ZXMoY2FuZGlkYXRlVXJsLCB0aGlzLnN0b3JhZ2UuZ2V0KGdlbmVyYXRpb25IYXNoKSB8fCB0aGlzLnN0b3JhZ2UuZ2V0TGF0ZXN0KCkpOwogICAgICB2YXIgaXNDYW5kaWRhdGVVcmxBdmFpbGFibGUgPSB0cnVlOwogICAgICB2YXIgcmVwb3NpdG9yeUZhY3RvcnlPYnNlcnZhYmxlID0gZnJvbShwb3NzaWJsZVVybHMpLnBpcGUoY29uY2F0TWFwKGZ1bmN0aW9uICh1cmwpIHsKICAgICAgICBpZiAodXJsID09PSBjYW5kaWRhdGVVcmwpIHsKICAgICAgICAgIF90aGlzLmNyZWF0ZVJlcG9zaXRvcnlGYWN0b3J5KHVybCkucGlwZShpc0VtcHR5KCkpLnN1YnNjcmliZShmdW5jdGlvbiAoaXNFbXB0eSkgewogICAgICAgICAgICByZXR1cm4gaXNDYW5kaWRhdGVVcmxBdmFpbGFibGUgPSAhaXNFbXB0eTsKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIF90aGlzLmNyZWF0ZVJlcG9zaXRvcnlGYWN0b3J5KHVybCk7CiAgICAgIH0pKS5waXBlKHRha2UoMSkpOwogICAgICByZXR1cm4gcmVwb3NpdG9yeUZhY3RvcnlPYnNlcnZhYmxlLnBpcGUoZmxhdE1hcChmdW5jdGlvbiAoX3JlZikgewogICAgICAgIHZhciB1cmwgPSBfcmVmLnVybCwKICAgICAgICAgICAgcmVwb3NpdG9yeUZhY3RvcnkgPSBfcmVmLnJlcG9zaXRvcnlGYWN0b3J5OwogICAgICAgIHJldHVybiByZXBvc2l0b3J5RmFjdG9yeS5nZXRHZW5lcmF0aW9uSGFzaCgpLnBpcGUoZmxhdE1hcChmdW5jdGlvbiAoZ2VuZXJhdGlvbkhhc2gpIHsKICAgICAgICAgIHZhciBzdG9yZWROZXR3b3JrTW9kZWwgPSBfdGhpcy5zdG9yYWdlLmdldChnZW5lcmF0aW9uSGFzaCk7CgogICAgICAgICAgdmFyIG5ldHdvcmtSZXBvc2l0b3J5ID0gcmVwb3NpdG9yeUZhY3RvcnkuY3JlYXRlTmV0d29ya1JlcG9zaXRvcnkoKTsKICAgICAgICAgIHZhciBub2RlUmVwb3NpdG9yeSA9IHJlcG9zaXRvcnlGYWN0b3J5LmNyZWF0ZU5vZGVSZXBvc2l0b3J5KCk7CiAgICAgICAgICB2YXIgbmV0d29ya1R5cGVPYnNlcnZhYmxlID0gcmVwb3NpdG9yeUZhY3RvcnkuZ2V0TmV0d29ya1R5cGUoKS5waXBlKE9ic2VydmFibGVIZWxwZXJzLmRlZmF1bHRMYXN0KHN0b3JlZE5ldHdvcmtNb2RlbCAmJiBzdG9yZWROZXR3b3JrTW9kZWwubmV0d29ya1R5cGUgfHwgbmV0d29ya0NvbmZpZy5kZWZhdWx0TmV0d29ya1R5cGUpKTsKICAgICAgICAgIHZhciBnZW5lcmF0aW9uSGFzaE9ic2VydmFibGUgPSByZXBvc2l0b3J5RmFjdG9yeS5nZXRHZW5lcmF0aW9uSGFzaCgpLnBpcGUoT2JzZXJ2YWJsZUhlbHBlcnMuZGVmYXVsdExhc3Qoc3RvcmVkTmV0d29ya01vZGVsICYmIHN0b3JlZE5ldHdvcmtNb2RlbC5nZW5lcmF0aW9uSGFzaCkpOwogICAgICAgICAgdmFyIG5ldHdvcmtQcm9wZXJ0aWVzT2JzZXJ2YWJsZSA9IG5ldHdvcmtSZXBvc2l0b3J5LmdldE5ldHdvcmtQcm9wZXJ0aWVzKCkucGlwZShtYXAoZnVuY3Rpb24gKGQpIHsKICAgICAgICAgICAgcmV0dXJuIF90aGlzLnRvTmV0d29ya0NvbmZpZ3VyYXRpb25Nb2RlbChkKTsKICAgICAgICAgIH0pLCBPYnNlcnZhYmxlSGVscGVycy5kZWZhdWx0TGFzdChzdG9yZWROZXR3b3JrTW9kZWwgJiYgc3RvcmVkTmV0d29ya01vZGVsLm5ldHdvcmtDb25maWd1cmF0aW9uKSk7CiAgICAgICAgICB2YXIgbm9kZUluZm9PYnNlcnZhYmxlID0gbm9kZVJlcG9zaXRvcnkuZ2V0Tm9kZUluZm8oKS5waXBlKE9ic2VydmFibGVIZWxwZXJzLmRlZmF1bHRMYXN0KHN0b3JlZE5ldHdvcmtNb2RlbCAmJiBzdG9yZWROZXR3b3JrTW9kZWwubm9kZUluZm8pKTsKICAgICAgICAgIHZhciB0cmFuc2FjdGlvbkZlZXNPYnNlcnZhYmxlID0gcmVwb3NpdG9yeUZhY3RvcnkuY3JlYXRlTmV0d29ya1JlcG9zaXRvcnkoKS5nZXRUcmFuc2FjdGlvbkZlZXMoKS5waXBlKE9ic2VydmFibGVIZWxwZXJzLmRlZmF1bHRMYXN0KHN0b3JlZE5ldHdvcmtNb2RlbCAmJiBzdG9yZWROZXR3b3JrTW9kZWwudHJhbnNhY3Rpb25GZWVzKSk7CiAgICAgICAgICByZXR1cm4gY29tYmluZUxhdGVzdChbbmV0d29ya1R5cGVPYnNlcnZhYmxlLCBnZW5lcmF0aW9uSGFzaE9ic2VydmFibGUsIG5ldHdvcmtQcm9wZXJ0aWVzT2JzZXJ2YWJsZSwgbm9kZUluZm9PYnNlcnZhYmxlLCB0cmFuc2FjdGlvbkZlZXNPYnNlcnZhYmxlXSkucGlwZShtYXAoZnVuY3Rpb24gKF9yZWYyKSB7CiAgICAgICAgICAgIHZhciBfcmVmMyA9IF9zbGljZWRUb0FycmF5KF9yZWYyLCA1KSwKICAgICAgICAgICAgICAgIG5ldHdvcmtUeXBlID0gX3JlZjNbMF0sCiAgICAgICAgICAgICAgICBnZW5lcmF0aW9uSGFzaCA9IF9yZWYzWzFdLAogICAgICAgICAgICAgICAgbmV0d29ya1Byb3BlcnRpZXMgPSBfcmVmM1syXSwKICAgICAgICAgICAgICAgIG5vZGVJbmZvID0gX3JlZjNbM10sCiAgICAgICAgICAgICAgICB0cmFuc2FjdGlvbkZlZXMgPSBfcmVmM1s0XTsKCiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgZmFsbGJhY2s6ICEhY2FuZGlkYXRlVXJsICYmIGNhbmRpZGF0ZVVybCAhPT0gdXJsLAogICAgICAgICAgICAgIG5ldHdvcmtNb2RlbDogbmV3IE5ldHdvcmtNb2RlbCh1cmwsIG5ldHdvcmtUeXBlLCBnZW5lcmF0aW9uSGFzaCwgbmV0d29ya1Byb3BlcnRpZXMsIHRyYW5zYWN0aW9uRmVlcywgbm9kZUluZm8pLAogICAgICAgICAgICAgIHJlcG9zaXRvcnlGYWN0b3J5OiByZXBvc2l0b3J5RmFjdG9yeSwKICAgICAgICAgICAgICBpc0NhbmRpZGF0ZVVybEF2YWlsYWJsZTogaXNDYW5kaWRhdGVVcmxBdmFpbGFibGUKICAgICAgICAgICAgfTsKICAgICAgICAgIH0pLCB0YXAoZnVuY3Rpb24gKHApIHsKICAgICAgICAgICAgcmV0dXJuIF90aGlzLnN0b3JhZ2Uuc2V0KGdlbmVyYXRpb25IYXNoLCBwLm5ldHdvcmtNb2RlbCk7CiAgICAgICAgICB9KSk7CiAgICAgICAgfSkpOwogICAgICB9KSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY3JlYXRlUmVwb3NpdG9yeUZhY3RvcnkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZVJlcG9zaXRvcnlGYWN0b3J5KHVybCkgewogICAgICBjb25zb2xlLmxvZygiVGVzdGluZyAiLmNvbmNhdCh1cmwpKTsKICAgICAgdmFyIHJlcG9zaXRvcnlGYWN0b3J5ID0gTmV0d29ya1NlcnZpY2UuY3JlYXRlUmVwb3NpdG9yeUZhY3RvcnkodXJsKTsKICAgICAgcmV0dXJuIGRlZmVyKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gcmVwb3NpdG9yeUZhY3RvcnkuZ2V0R2VuZXJhdGlvbkhhc2goKTsKICAgICAgfSkucGlwZShtYXAoZnVuY3Rpb24gKCkgewogICAgICAgIGNvbnNvbGUubG9nKCJQZWVyICIuY29uY2F0KHVybCwgIiBzZWVtcyBPSyIpKTsKICAgICAgICByZXR1cm4gewogICAgICAgICAgdXJsOiB1cmwsCiAgICAgICAgICByZXBvc2l0b3J5RmFjdG9yeTogcmVwb3NpdG9yeUZhY3RvcnkKICAgICAgICB9OwogICAgICB9KSwgY2F0Y2hFcnJvcihmdW5jdGlvbiAoZSkgewogICAgICAgIGNvbnNvbGUubG9nKCJQZWVyICIuY29uY2F0KHVybCwgIiBzZWVtcyBkb3duLiBJZ25vcmluZy4gRXJyb3I6ICIpLmNvbmNhdChlLm1lc3NhZ2UpLCBlKTsKICAgICAgICByZXR1cm4gRU1QVFk7CiAgICAgIH0pKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ0b05ldHdvcmtDb25maWd1cmF0aW9uTW9kZWwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHRvTmV0d29ya0NvbmZpZ3VyYXRpb25Nb2RlbChkdG8pIHsKICAgICAgdmFyIGZpbGVEZWZhdWx0cyA9IG5ldHdvcmtDb25maWcubmV0d29ya0NvbmZpZ3VyYXRpb25EZWZhdWx0czsKICAgICAgdmFyIGZyb21EdG8gPSB7CiAgICAgICAgZXBvY2hBZGp1c3RtZW50OiBOZXR3b3JrQ29uZmlndXJhdGlvbkhlbHBlcnMuZXBvY2hBZGp1c3RtZW50KGR0byksCiAgICAgICAgbWF4TW9zYWljRGl2aXNpYmlsaXR5OiBOZXR3b3JrQ29uZmlndXJhdGlvbkhlbHBlcnMubWF4TW9zYWljRGl2aXNpYmlsaXR5KGR0byksCiAgICAgICAgbmFtZXNwYWNlR3JhY2VQZXJpb2REdXJhdGlvbjogTmV0d29ya0NvbmZpZ3VyYXRpb25IZWxwZXJzLm5hbWVzcGFjZUdyYWNlUGVyaW9kRHVyYXRpb24oZHRvKSwKICAgICAgICBsb2NrZWRGdW5kc1BlckFnZ3JlZ2F0ZTogTmV0d29ya0NvbmZpZ3VyYXRpb25IZWxwZXJzLmxvY2tlZEZ1bmRzUGVyQWdncmVnYXRlKGR0byksCiAgICAgICAgbWF4Q29zaWduYXRvcmllc1BlckFjY291bnQ6IE5ldHdvcmtDb25maWd1cmF0aW9uSGVscGVycy5tYXhDb3NpZ25hdG9yaWVzUGVyQWNjb3VudChkdG8pLAogICAgICAgIGJsb2NrR2VuZXJhdGlvblRhcmdldFRpbWU6IE5ldHdvcmtDb25maWd1cmF0aW9uSGVscGVycy5ibG9ja0dlbmVyYXRpb25UYXJnZXRUaW1lKGR0byksCiAgICAgICAgbWF4TmFtZXNwYWNlRGVwdGg6IE5ldHdvcmtDb25maWd1cmF0aW9uSGVscGVycy5tYXhOYW1lc3BhY2VEZXB0aChkdG8pLAogICAgICAgIG1heE1vc2FpY0R1cmF0aW9uOiBOZXR3b3JrQ29uZmlndXJhdGlvbkhlbHBlcnMubWF4TW9zYWljRHVyYXRpb24oZHRvKSwKICAgICAgICBtaW5OYW1lc3BhY2VEdXJhdGlvbjogTmV0d29ya0NvbmZpZ3VyYXRpb25IZWxwZXJzLm1pbk5hbWVzcGFjZUR1cmF0aW9uKGR0byksCiAgICAgICAgbWF4TmFtZXNwYWNlRHVyYXRpb246IE5ldHdvcmtDb25maWd1cmF0aW9uSGVscGVycy5tYXhOYW1lc3BhY2VEdXJhdGlvbihkdG8pLAogICAgICAgIG1heFRyYW5zYWN0aW9uc1BlckFnZ3JlZ2F0ZTogTmV0d29ya0NvbmZpZ3VyYXRpb25IZWxwZXJzLm1heFRyYW5zYWN0aW9uc1BlckFnZ3JlZ2F0ZShkdG8pLAogICAgICAgIG1heENvc2lnbmVkQWNjb3VudHNQZXJBY2NvdW50OiBOZXR3b3JrQ29uZmlndXJhdGlvbkhlbHBlcnMubWF4Q29zaWduZWRBY2NvdW50c1BlckFjY291bnQoZHRvKSwKICAgICAgICBtYXhNZXNzYWdlU2l6ZTogTmV0d29ya0NvbmZpZ3VyYXRpb25IZWxwZXJzLm1heE1lc3NhZ2VTaXplKGR0byksCiAgICAgICAgbWF4TW9zYWljQXRvbWljVW5pdHM6IE5ldHdvcmtDb25maWd1cmF0aW9uSGVscGVycy5tYXhNb3NhaWNBdG9taWNVbml0cyhkdG8pLAogICAgICAgIGN1cnJlbmN5TW9zYWljSWQ6IE5ldHdvcmtDb25maWd1cmF0aW9uSGVscGVycy5jdXJyZW5jeU1vc2FpY0lkKGR0byksCiAgICAgICAgaGFydmVzdGluZ01vc2FpY0lkOiBOZXR3b3JrQ29uZmlndXJhdGlvbkhlbHBlcnMuaGFydmVzdGluZ01vc2FpY0lkKGR0byksCiAgICAgICAgZGVmYXVsdER5bmFtaWNGZWVNdWx0aXBsaWVyOiBOZXR3b3JrQ29uZmlndXJhdGlvbkhlbHBlcnMuZGVmYXVsdER5bmFtaWNGZWVNdWx0aXBsaWVyKGR0bykKICAgICAgfTsKICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgZmlsZURlZmF1bHRzKSwgZnJvbUR0byk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVzb2x2ZUNhbmRpZGF0ZXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlc29sdmVDYW5kaWRhdGVzKG5ld1VybCwgc3RvcmVkTmV0d29ya01vZGVsKSB7CiAgICAgIC8vIFNob3VsZCB3ZSBsb2FkIGNhY2hlZCBjYW5kaWRhdGVzIGluIHRoZSBub2RlIHRhYmxlcz8KICAgICAgcmV0dXJuIF8udW5pcShbbmV3VXJsLCBzdG9yZWROZXR3b3JrTW9kZWwgJiYgc3RvcmVkTmV0d29ya01vZGVsLnVybCwgbmV0d29ya0NvbmZpZy5kZWZhdWx0Tm9kZVVybF0uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShuZXR3b3JrQ29uZmlnLm5vZGVzLm1hcChmdW5jdGlvbiAobikgewogICAgICAgIHJldHVybiBuLnVybDsKICAgICAgfSkpKS5maWx0ZXIoZnVuY3Rpb24gKHApIHsKICAgICAgICByZXR1cm4gcCAhPT0gdW5kZWZpbmVkICYmIHAubGVuZ3RoOwogICAgICB9KSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVzZXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlc2V0KGdlbmVyYXRpb25IYXNoKSB7CiAgICAgIHRoaXMuc3RvcmFnZS5yZW1vdmUoZ2VuZXJhdGlvbkhhc2gpOwogICAgfQogICAgLyoqCiAgICAgKiBJdCBjcmVhdGVzIHRoZSBSZXBvc2l0b3J5RmFjdG9yeSB1c2VkIHRvIGJ1aWxkIHRoZSBodHRwIHJlcG9zaXRvcnkvY2xpZW50cyBhbmQgbGlzdGVuZXJzLgogICAgICogQHBhcmFtIHVybCB0aGUgdXJsLgogICAgICovCgogIH1dLCBbewogICAga2V5OiAiY3JlYXRlUmVwb3NpdG9yeUZhY3RvcnkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZVJlcG9zaXRvcnlGYWN0b3J5KHVybCkgewogICAgICByZXR1cm4gbmV3IFJlcG9zaXRvcnlGYWN0b3J5SHR0cCh1cmwsIHsKICAgICAgICB3ZWJzb2NrZXRVcmw6IFVSTEhlbHBlcnMuaHR0cFRvV3NVcmwodXJsKSArICcvd3MnLAogICAgICAgIHdlYnNvY2tldEluamVjdGVkOiBXZWJTb2NrZXQKICAgICAgfSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gTmV0d29ya1NlcnZpY2U7Cn0oKTs="},{"version":3,"sources":["/home/hero/lared-wallet/src/services/NetworkService.ts"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright 2020 NEM (https://nem.io)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\n\nimport { NetworkModel } from '@/core/database/entities/NetworkModel';\nimport { NetworkConfiguration, RepositoryFactory, RepositoryFactoryHttp } from 'symbol-sdk';\nimport { URLHelpers } from '@/core/utils/URLHelpers';\nimport { combineLatest, defer, EMPTY, from, Observable } from 'rxjs';\nimport { catchError, concatMap, flatMap, map, take, tap, isEmpty } from 'rxjs/operators';\nimport * as _ from 'lodash';\n\nimport { ObservableHelpers } from '@/core/utils/ObservableHelpers';\n\nimport { networkConfig } from '@/config';\nimport { NetworkConfigurationModel } from '@/core/database/entities/NetworkConfigurationModel';\nimport { NetworkConfigurationHelpers } from '@/core/utils/NetworkConfigurationHelpers';\nimport { NetworkModelStorage } from '@/core/database/storage/NetworkModelStorage';\n\n/**\n * The service in charge of loading and caching anything related to Network from Rest.\n * The cache is done by storing the payloads in SimpleObjectStorage.\n */\nexport class NetworkService {\n    /**\n     * The network information local cache.\n     */\n    private readonly storage = NetworkModelStorage.INSTANCE;\n\n    /**\n     * The best default Url. It uses the stored condiguration if possible.\n     */\n    public getDefaultUrl(): string {\n        const storedNetworkModel = this.storage.getLatest();\n        return URLHelpers.formatUrl((storedNetworkModel && storedNetworkModel.url) || networkConfig.defaultNodeUrl).url;\n    }\n\n    /**\n     * This method get the network data from the provided URL. If the server in the candidateUrl is down,\n     * the next available url will be used.\n     *\n     * @param candidateUrl the new url.\n     * @param generationHash of the current profile\n     */\n    public getNetworkModel(\n        candidateUrl: string | undefined,\n        generationHash?: string | undefined,\n    ): Observable<{\n        fallback: boolean;\n        networkModel: NetworkModel;\n        repositoryFactory: RepositoryFactory;\n        isCandidateUrlAvailable: boolean;\n    }> {\n        const possibleUrls = this.resolveCandidates(candidateUrl, this.storage.get(generationHash) || this.storage.getLatest());\n        let isCandidateUrlAvailable: boolean = true;\n        const repositoryFactoryObservable = from(possibleUrls)\n            .pipe(\n                concatMap((url) => {\n                    if (url === candidateUrl) {\n                        this.createRepositoryFactory(url)\n                            .pipe(isEmpty())\n                            .subscribe((isEmpty) => (isCandidateUrlAvailable = !isEmpty));\n                    }\n                    return this.createRepositoryFactory(url);\n                }),\n            )\n            .pipe(take(1));\n        return repositoryFactoryObservable.pipe(\n            flatMap(({ url, repositoryFactory }) => {\n                return repositoryFactory.getGenerationHash().pipe(\n                    flatMap((generationHash) => {\n                        const storedNetworkModel = this.storage.get(generationHash);\n                        const networkRepository = repositoryFactory.createNetworkRepository();\n                        const nodeRepository = repositoryFactory.createNodeRepository();\n                        const networkTypeObservable = repositoryFactory\n                            .getNetworkType()\n                            .pipe(\n                                ObservableHelpers.defaultLast(\n                                    (storedNetworkModel && storedNetworkModel.networkType) || networkConfig.defaultNetworkType,\n                                ),\n                            );\n                        const generationHashObservable = repositoryFactory\n                            .getGenerationHash()\n                            .pipe(ObservableHelpers.defaultLast(storedNetworkModel && storedNetworkModel.generationHash));\n\n                        const networkPropertiesObservable = networkRepository.getNetworkProperties().pipe(\n                            map((d) => this.toNetworkConfigurationModel(d)),\n                            ObservableHelpers.defaultLast(storedNetworkModel && storedNetworkModel.networkConfiguration),\n                        );\n                        const nodeInfoObservable = nodeRepository\n                            .getNodeInfo()\n                            .pipe(ObservableHelpers.defaultLast(storedNetworkModel && storedNetworkModel.nodeInfo));\n\n                        const transactionFeesObservable = repositoryFactory\n                            .createNetworkRepository()\n                            .getTransactionFees()\n                            .pipe(ObservableHelpers.defaultLast(storedNetworkModel && storedNetworkModel.transactionFees));\n\n                        return combineLatest([\n                            networkTypeObservable,\n                            generationHashObservable,\n                            networkPropertiesObservable,\n                            nodeInfoObservable,\n                            transactionFeesObservable,\n                        ]).pipe(\n                            map(([networkType, generationHash, networkProperties, nodeInfo, transactionFees]) => {\n                                return {\n                                    fallback: !!candidateUrl && candidateUrl !== url,\n                                    networkModel: new NetworkModel(\n                                        url,\n                                        networkType,\n                                        generationHash,\n                                        networkProperties,\n                                        transactionFees,\n                                        nodeInfo,\n                                    ),\n                                    repositoryFactory,\n                                    isCandidateUrlAvailable,\n                                };\n                            }),\n                            tap((p) => this.storage.set(generationHash, p.networkModel)),\n                        );\n                    }),\n                );\n            }),\n        );\n    }\n\n    private createRepositoryFactory(url: string): Observable<{ url: string; repositoryFactory: RepositoryFactory }> {\n        console.log(`Testing ${url}`);\n        const repositoryFactory = NetworkService.createRepositoryFactory(url);\n        return defer(() => {\n            return repositoryFactory.getGenerationHash();\n        }).pipe(\n            map(() => {\n                console.log(`Peer ${url} seems OK`);\n                return { url, repositoryFactory };\n            }),\n            catchError((e) => {\n                console.log(`Peer ${url} seems down. Ignoring. Error: ${e.message}`, e);\n                return EMPTY;\n            }),\n        );\n    }\n\n    private toNetworkConfigurationModel(dto: NetworkConfiguration): NetworkConfigurationModel {\n        const fileDefaults: NetworkConfigurationModel = networkConfig.networkConfigurationDefaults;\n        const fromDto: NetworkConfigurationModel = {\n            epochAdjustment: NetworkConfigurationHelpers.epochAdjustment(dto),\n            maxMosaicDivisibility: NetworkConfigurationHelpers.maxMosaicDivisibility(dto),\n            namespaceGracePeriodDuration: NetworkConfigurationHelpers.namespaceGracePeriodDuration(dto),\n            lockedFundsPerAggregate: NetworkConfigurationHelpers.lockedFundsPerAggregate(dto),\n            maxCosignatoriesPerAccount: NetworkConfigurationHelpers.maxCosignatoriesPerAccount(dto),\n            blockGenerationTargetTime: NetworkConfigurationHelpers.blockGenerationTargetTime(dto),\n            maxNamespaceDepth: NetworkConfigurationHelpers.maxNamespaceDepth(dto),\n            maxMosaicDuration: NetworkConfigurationHelpers.maxMosaicDuration(dto),\n            minNamespaceDuration: NetworkConfigurationHelpers.minNamespaceDuration(dto),\n            maxNamespaceDuration: NetworkConfigurationHelpers.maxNamespaceDuration(dto),\n            maxTransactionsPerAggregate: NetworkConfigurationHelpers.maxTransactionsPerAggregate(dto),\n            maxCosignedAccountsPerAccount: NetworkConfigurationHelpers.maxCosignedAccountsPerAccount(dto),\n            maxMessageSize: NetworkConfigurationHelpers.maxMessageSize(dto),\n            maxMosaicAtomicUnits: NetworkConfigurationHelpers.maxMosaicAtomicUnits(dto),\n            currencyMosaicId: NetworkConfigurationHelpers.currencyMosaicId(dto),\n            harvestingMosaicId: NetworkConfigurationHelpers.harvestingMosaicId(dto),\n            defaultDynamicFeeMultiplier: NetworkConfigurationHelpers.defaultDynamicFeeMultiplier(dto),\n        };\n        return { ...fileDefaults, ...fromDto };\n    }\n\n    private resolveCandidates(newUrl: string | undefined, storedNetworkModel: NetworkModel | undefined): string[] {\n        // Should we load cached candidates in the node tables?\n        return _.uniq(\n            [\n                newUrl,\n                storedNetworkModel && storedNetworkModel.url,\n                networkConfig.defaultNodeUrl,\n                ...networkConfig.nodes.map((n) => n.url),\n            ].filter((p) => p !== undefined && p.length),\n        );\n    }\n\n    public reset(generationHash: string) {\n        this.storage.remove(generationHash);\n    }\n\n    /**\n     * It creates the RepositoryFactory used to build the http repository/clients and listeners.\n     * @param url the url.\n     */\n    public static createRepositoryFactory(url: string): RepositoryFactory {\n        return new RepositoryFactoryHttp(url, {\n            websocketUrl: URLHelpers.httpToWsUrl(url) + '/ws',\n            websocketInjected: WebSocket,\n        });\n    }\n}\n"],"sourceRoot":""}]}